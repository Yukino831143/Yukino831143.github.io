{"meta":{"title":"yukino","subtitle":null,"description":"ä¸€æšç¨‹åºå‘˜çš„æ—¥å¸¸","author":"yukino","url":""},"pages":[{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2020-04-07T15:17:05.788Z","comments":false,"path":"bangumi/index.html","permalink":"/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"about","date":"2018-12-12T14:14:36.000Z","updated":"2020-07-12T17:26:11.126Z","comments":false,"path":"about/index.html","permalink":"/about/index.html","excerpt":"","text":"[Yukino] ä¸&nbsp; Yukino&nbsp; ï¼ˆ Yukino ï¼‰ å¯¹è¯ä¸­... bot_ui_ini()","keywords":"å…³äº"},{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2020-04-11T08:06:25.935Z","comments":false,"path":"client/index.html","permalink":"/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2020-04-11T08:06:25.936Z","comments":false,"path":"donate/index.html","permalink":"/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2020-04-11T08:06:25.936Z","comments":false,"path":"lab/index.html","permalink":"/lab/index.html","excerpt":"","text":"sakura ä¸»é¢˜balabala","keywords":"Labå®éªŒå®¤"},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2020-04-11T08:06:25.935Z","comments":true,"path":"comment/index.html","permalink":"/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2020-04-11T08:06:25.937Z","comments":true,"path":"links/index.html","permalink":"/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2020-04-11T08:06:25.937Z","comments":false,"path":"music/index.html","permalink":"/music/index.html","excerpt":"","text":"","keywords":"å–œæ¬¢çš„éŸ³ä¹"},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2020-04-07T15:17:05.790Z","comments":true,"path":"rss/index.html","permalink":"/rss/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2020-04-07T15:17:05.790Z","comments":true,"path":"tags/index.html","permalink":"/tags/index.html","excerpt":"","text":""},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2020-07-12T17:26:11.127Z","comments":false,"path":"theme-sakura/index.html","permalink":"/theme-sakura/index.html","excerpt":"","text":"Hexoä¸»é¢˜Sakuraä¿®æ”¹è‡ªWordPressä¸»é¢˜Sakuraï¼Œæ„Ÿè°¢åŸä½œè€…Mashiro","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2020-04-07T15:17:05.791Z","comments":false,"path":"video/index.html","permalink":"/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"}],"posts":[{"title":"Daily Review","slug":"ç”Ÿæ´»/Daily Review","date":"2020-10-20T18:20:00.000Z","updated":"2020-10-20T18:20:35.996Z","comments":true,"path":"2020/10/21/ç”Ÿæ´»/Daily Review/","link":"","permalink":"/2020/10/21/ç”Ÿæ´»/Daily Review/","excerpt":"","text":"2020-10-20 code study 23:50 - 1:50 ä¸‹ç­æ—¶é—´ : 22:20 Javaçš„åŸºç¡€çŸ¥è¯†ï¼Œå‡†å¤‡é¢è¯•å†…å®¹ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ è§£bugçš„é€Ÿåº¦è¿œæ¯”ä¸ä¸ŠæŠ¥bugçš„é€Ÿåº¦ã€‚åˆæŠ¥äº†ä¸€å¤§æ³¢äº§çº¿é—®é¢˜ ä¿®æ”¹äº†ç®€å†ã€‚ æ˜å¤©æœ‰éŸ³é¢‘åŸºç¡€çŸ¥è¯†æˆè¯¾ã€‚æ˜å¤©æ—©ä¸Šå‡†å¤‡ä¸€æ³¢ 2020-10-19 code study 22:30 - 1:45 ä¸‹ç­æ—¶é—´ : 21:20 spring mvc çš„ restfulé£æ ¼ å’Œ æ‹¦æˆªå™¨ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ å­—èŠ‚è·³åŠ¨ é¢è¯•é‚€è¯·ï¼Œæ¥ä¸‹æ¥çš„ä¸€å‘¨å‡†å¤‡é¢è¯• ä¸­ç§»ç‰©è”ç½‘ï¼Œè¿˜æœªä¿®æ”¹ç®€å†ï¼Œå‡†å¤‡æŠ•ä¸€æ³¢ oppoçš„å·¥ä½œå¥½å¿™ï¼Œé¡¹ç›®çš„ä¸€å¤§æ³¢bugè¦è§£ï¼Œä¸€å¤§æ³¢featureéœ€è¦ç§»æ¤","categories":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"/categories/ç”Ÿæ´»/"}],"tags":[{"name":"Daily Review","slug":"Daily-Review","permalink":"/tags/Daily-Review/"}],"keywords":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"/categories/ç”Ÿæ´»/"}]},{"title":"æ‹¦æˆªå™¨-Interceptor","slug":"æŠ€æœ¯/æ‹¦æˆªå™¨-Interceptor","date":"2020-10-19T17:50:00.000Z","updated":"2020-10-19T17:53:15.861Z","comments":true,"path":"2020/10/20/æŠ€æœ¯/æ‹¦æˆªå™¨-Interceptor/","link":"","permalink":"/2020/10/20/æŠ€æœ¯/æ‹¦æˆªå™¨-Interceptor/","excerpt":"","text":"æ‹¦æˆªå™¨(Interceptor)ç”¨äºå¯¹URLè¯·æ±‚è¿›è¡Œå‰ç½®/åç½®è¿‡æ»¤ Interceptorä¸Filterç”¨é€”ç›¸ä¼¼ï¼Œä½†å®ç°æ–¹å¼ä¸åŒ Interceptoråº•å±‚å°±æ˜¯åŸºäºSpring Aopé¢å‘åˆ‡é¢ç¼–ç¨‹å®ç° 1.æ‹¦æˆªå™¨å…¥é—¨&lt;!--pom.xml--&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!--applicationContext.xml--&gt; &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.MyInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; @RestController @RequestMapping(&quot;/restful&quot;) //@CrossOrigin(origins = {&quot;http://localhost:8080&quot;,&quot;http://www.imooc.com&quot;}) //@CrossOrigin(origins = &quot;*&quot;,maxAge = 3600) public class RestfulController { @GetMapping(&quot;/persons&quot;) public List&lt;Person&gt; findPersons(){ List list = new ArrayList(); Person p1 = new Person(); p1.setName(&quot;lily&quot;); p1.setAge(23); p1.setBirthday(new Date()); Person p2 = new Person(); p2.setName(&quot;smith&quot;); p2.setAge(22); p2.setBirthday(new Date()); list.add(p1); list.add(p2); System.out.println(&quot;RestfulController.findPersons() - return list&quot;); return list; } } public class MyInterceptor implements HandlerInterceptor { public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(request.getRequestURL() + &quot;-å‡†å¤‡æ‰§è¡Œ&quot;); // response.getWriter().print(&quot;[]&quot;); return true;//è¿”å›falseä¼šç›´æ¥æ‹¦æˆªï¼Œä¸è¿›è¡Œä¸‹ä¸€æ­¥ä¼ é€’ } public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(request.getRequestURL() + &quot;-ç›®æ ‡å¤„ç†æˆåŠŸ&quot;); } public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(request.getRequestURL() + &quot;-å“åº”å†…å®¹å·²äº§ç”Ÿ&quot;); } } preHandle -å‰ç½®æ‰§è¡Œå¤„ç† postHandle - ç›®æ ‡èµ„æºå·²ç»è¢«Spring mvc æ¡†æ¶å¤„ç† afterCompletion - å“åº”æ–‡æœ¬å·²ç»äº§ç”Ÿ æ‰“å°log http://localhost:8080/restful/persons-å‡†å¤‡æ‰§è¡Œ RestfulController.findPersons() - return list http://localhost:8080/restful/persons-ç›®æ ‡å¤„ç†æˆåŠŸ http://localhost:8080/restful/persons-å“åº”å†…å®¹å·²äº§ç”Ÿ é™æ€èµ„æºå¤„ç† å› ä¸ºæŒ‰ç…§ä¸Šé¢çš„é…ç½®ï¼Œå½“è®¿é—®é™æ€èµ„æºä¹Ÿä¼šè¿›è¡Œæ‹¦æˆªï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸åˆç†çš„ã€‚ &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;mvc:mapping path=&quot;/restful/**&quot;/&gt; &lt;mvc:mapping path=&quot;/webapi/**&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.ico&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.jpg&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.gif&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.js&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.css&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/resources/**&quot;/&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.MyInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; æ‰‹åŠ¨æ’é™¤é™æ€èµ„æº/**.ico å°†é™æ€èµ„æºæ”¾åœ¨ç»Ÿä¸€ç›®å½•/resource/ æŒ‡å®šè®¿é—®çš„é“¾æ¥ /restful/** 2.å¤šæ‹¦æˆªå™¨é—®é¢˜ &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;mvc:mapping path=&quot;/restful/**&quot;/&gt; &lt;mvc:mapping path=&quot;/webapi/**&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.ico&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.jpg&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.gif&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.js&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.css&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/resources/**&quot;/&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.MyInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;mvc:mapping path=&quot;/restful/**&quot;/&gt; &lt;mvc:mapping path=&quot;/webapi/**&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.ico&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.jpg&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.gif&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.js&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.css&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/resources/**&quot;/&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.MyInterceptor1&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; public class MyInterceptor implements HandlerInterceptor { public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(request.getRequestURL() + &quot;-å‡†å¤‡æ‰§è¡Œ&quot;); // response.getWriter().print(&quot;[]&quot;);//æ‹¦æˆªå™¨è¾“å‡ºåˆ°å‰ç«¯ return true;//è¿”å›falseä¼šç›´æ¥æ‹¦æˆªï¼Œä¸è¿›è¡Œä¸‹ä¸€æ­¥ä¼ é€’ } public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(request.getRequestURL() + &quot;-ç›®æ ‡å¤„ç†æˆåŠŸ&quot;); } public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(request.getRequestURL() + &quot;-å“åº”å†…å®¹å·²äº§ç”Ÿ&quot;); } } public class MyInterceptor1 implements HandlerInterceptor { public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(request.getRequestURL()+&quot;-å‡†å¤‡æ‰§è¡Œ-1&quot;); return true; } public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(request.getRequestURL()+&quot;-ç›®æ ‡å¤„ç†æˆåŠŸ-1&quot;); } public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(request.getRequestURL()+&quot;-å“åº”å†…å®¹å·²äº§ç”Ÿ-1&quot;); } } æ‰§è¡Œlog http://localhost:8080/restful/persons-å‡†å¤‡æ‰§è¡Œhttp://localhost:8080/restful/persons-å‡†å¤‡æ‰§è¡Œ-1RestfulController.findPersons() - return listhttp://localhost:8080/restful/persons-ç›®æ ‡å¤„ç†æˆåŠŸ-1http://localhost:8080/restful/persons-ç›®æ ‡å¤„ç†æˆåŠŸhttp://localhost:8080/restful/persons-å“åº”å†…å®¹å·²äº§ç”Ÿ-1http://localhost:8080/restful/persons-å“åº”å†…å®¹å·²äº§ç”Ÿ 3.ç”¨æˆ·æµé‡æ‹¦æˆªå™¨ å¼•å…¥logback &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-classic&lt;/artifactId&gt; &lt;version&gt;1.2.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; æ–°å»º resource/logback.xml&lt;!--logback.xml--&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt; &lt;!--å®šä¹‰å‘æ§åˆ¶å°è¾“å‡ºçš„è¿½åŠ å™¨--&gt; &lt;appender name=&quot;console&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; &lt;encoder&gt; &lt;pattern&gt;[%thread] %d %level %logger{10} - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--å®šä¹‰å‘logæ–‡ä»¶è¾“å‡ºçš„è¿½åŠ å™¨--&gt; &lt;appender name=&quot;accessHistoryLog&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt; &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &lt;fileNamePattern&gt;d:/logs/history.%d.log&lt;/fileNamePattern&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;[%thread] %d %level %logger{10} - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--è¾“å‡ºæœ€ä½çº§åˆ«debug--&gt; &lt;root level=&quot;debug&quot;&gt; &lt;appender-ref ref=&quot;console&quot;/&gt; &lt;/root&gt; &lt;logger name=&quot;com.imooc.restful.interceptor.AccessHistoryInterceptor&quot; level=&quot;INFO&quot; additivity=&quot;false&quot;&gt; &lt;!--level=&quot;INFO&quot; é»˜è®¤è¾“å‡ºç­‰çº§ additivity=&quot;false&quot; è¡¨ç¤ºä¸è¾“å‡ºåˆ°consoleï¼Œè¾“å‡ºåˆ°æ–‡ä»¶--&gt; &lt;appender-ref ref=&quot;accessHistoryLog&quot;/&gt; &lt;/logger&gt; &lt;/configuration&gt; &lt;!--applicationContext.xml--&gt; &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;mvc:mapping path=&quot;/**&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/resources/**&quot;/&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.AccessHistoryInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; &lt;pattern&gt;[%thread] %d %level %logger{10} - %msg%n&lt;/pattern&gt; %pattern çº¿ç¨‹å %d æ—¶é—´ %level æ—¥å¿—çº§åˆ« %logger{10} äº§ç”Ÿç±»æ—¥å¿—ï¼Œé™å®šé•¿åº¦10 %msg logä¿¡æ¯ %n æ¢è¡Œ RollingFileAppender ç”ŸæˆæŒ‰å¤©æ»šåŠ¨çš„æ–‡ä»¶ã€‚æ¯ä¸€å¤©ä¸€ä¸ªæ–‡ä»¶ã€‚ public class AccessHistoryInterceptor implements HandlerInterceptor { private Logger logger = LoggerFactory.getLogger(AccessHistoryInterceptor.class); public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { StringBuilder log = new StringBuilder(); log.append(request.getRemoteAddr()); log.append(&quot;|&quot;); log.append(request.getRequestURL()); log.append(&quot;|&quot;); log.append(request.getHeader(&quot;user-agent&quot;)); logger.info(log.toString()); return true; } } 4.Spring MVCå¤„ç†æµç¨‹","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Spring MVC","slug":"Spring-MVC","permalink":"/tags/Spring-MVC/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Restfulé£æ ¼","slug":"æŠ€æœ¯/Restful","date":"2020-10-19T13:00:00.000Z","updated":"2020-10-19T17:51:28.500Z","comments":true,"path":"2020/10/19/æŠ€æœ¯/Restful/","link":"","permalink":"/2020/10/19/æŠ€æœ¯/Restful/","excerpt":"","text":"0. åŸºç¡€ä»‹ç»Restfulå¼€å‘è§„èŒƒ ä½¿ç”¨URLä½œä¸ºç”¨æˆ·äº¤äº’å…¥å£ æ˜ç¡®çš„è¯­ä¹‰è§„èŒƒ(GET|POST|PUT|DELETE) GET æŸ¥è¯¢ POST æ–°å¢ PUT ä¿®æ”¹ DELETE åˆ é™¤ Refstfulå‘½åè¦æ±‚ 1.ç¯å¢ƒå‡†å¤‡&lt;!--web.xml--&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; version=&quot;3.1&quot;&gt; &lt;servlet&gt; &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;load-on-startup&gt;0&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;filter&gt; &lt;filter-name&gt;characterFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;characterFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; &lt;/web-app&gt; &lt;!--applicationContext.xml--&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mv=&quot;http://www.springframework.org/schema/mvc&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt; &lt;context:component-scan base-package=&quot;com.imooc.restful&quot;/&gt; &lt;mvc:annotation-driven&gt; &lt;mvc:message-converters&gt; &lt;bean class=&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;&gt; &lt;property name=&quot;supportedMediaTypes&quot;&gt; &lt;list&gt; &lt;!-- response.setContentType(&quot;text/html;charset=utf-8&quot;) --&gt; &lt;value&gt;text/html;charset=utf-8&lt;/value&gt; &lt;value&gt;application/json;charset=utf-8&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/mvc:message-converters&gt; &lt;/mvc:annotation-driven&gt; &lt;mvc:default-servlet-handler/&gt; &lt;/beans&gt; 2.Restful æ³¨è§£ @RestController - ä½¿ç”¨åœ¨ç±»ä¸Šï¼Œæ›¿ä»£æ¯ä¸ª@ResponseBodyï¼Œä»£è¡¨æ˜¯restfulæ•°æ®è€Œä¸æ˜¯é¡µé¢è·³è½¬ @PathVariable - è·¯å¾„å˜é‡æ³¨è§£ @GetMapping @PostMapping -å¯¹åº”è¯·æ±‚æ³¨è§£ &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;RESTfulå®éªŒå®¤&lt;/title&gt; &lt;script src=&quot;jquery-3.3.1.min.js&quot;&gt;&lt;/script&gt; &lt;script&gt; $(function(){ $(&quot;#btnGet&quot;).click(function () { $.ajax({ url : &quot;/restful/request&quot;, type : &quot;get&quot; , dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message); } }) }); }) $(function(){ $(&quot;#btnPost&quot;).click(function () { $.ajax({ url : &quot;/restful/request/100&quot;,//è·¯å¾„å˜é‡100 type : &quot;post&quot; , data : &quot;name=lily&amp;age=23&quot;,//æ•°æ® dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message+&quot;:&quot;+json.id); } }) }); }) $(function(){ $(&quot;#btnPut&quot;).click(function () { $.ajax({ url : &quot;/restful/request&quot;, type : &quot;put&quot; , data : &quot;name=lily&amp;age=23&quot;, dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message); } }) }); }) $(function(){ $(&quot;#btnDelete&quot;).click(function () { $.ajax({ url : &quot;/restful/request&quot;, type : &quot;delete&quot; , dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message); } }) }); }) $(function () { $(&quot;#btnPersons&quot;).click(function () { $.ajax({ url : &quot;/restful/persons&quot;, type : &quot;get&quot;, dataType : &quot;json&quot;, success : function(json){ console.info(json); for(var i = 0 ; i &lt; json.length;i++){ var p = json[i]; $(&quot;#divPersons&quot;).append(&quot;&lt;h2&gt;&quot; + p.name + &quot;-&quot; + p.age + &quot;-&quot; + p.birthday+ &quot;&lt;/h2&gt;&quot;) } } }) }) }) &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;input type=&quot;button&quot; id=&quot;btnGet&quot; value=&quot;å‘é€Getè¯·æ±‚&quot;&gt; &lt;input type=&quot;button&quot; id=&quot;btnPost&quot; value=&quot;å‘é€Postè¯·æ±‚&quot;&gt; &lt;input type=&quot;button&quot; id=&quot;btnPut&quot; value=&quot;å‘é€Putè¯·æ±‚&quot;&gt; &lt;input type=&quot;button&quot; id=&quot;btnDelete&quot; value=&quot;å‘é€Deleteè¯·æ±‚&quot;&gt; &lt;h1 id=&quot;message&quot;&gt;&lt;/h1&gt; &lt;hr/&gt; &lt;input type=&quot;button&quot; id=&quot;btnPersons&quot; value=&quot;æŸ¥è¯¢æ‰€æœ‰äººå‘˜&quot;&gt; &lt;div id=&quot;divPersons&quot;&gt;&lt;/div&gt; &lt;/body&gt; &lt;/html&gt; @RestController //æ›¿ä»£æ¯ä¸ª@ResponseBodyï¼Œä»£è¡¨æ˜¯restfulæ•°æ®è€Œä¸æ˜¯é¡µé¢è·³è½¬ @RequestMapping(&quot;/restful&quot;) public class RestfulController { @GetMapping(&quot;/request&quot;) //@ResponseBody public String doGetRequest(){ return &quot;{\\&quot;message\\&quot;:\\&quot;è¿”å›æŸ¥è¯¢ç»“æœ\\&quot;}&quot;; } // POST /article/1 // POST /restful/request/100 // è·å–è·¯å¾„å˜é‡ @PostMapping(&quot;/request/{rid}&quot;) //@ResponseBody public String doPostRequest(@PathVariable(&quot;rid&quot;) Integer requestId, Person person){ System.out.println(person.getName() + &quot;:&quot; + person.getAge()); return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®æ–°å»ºæˆåŠŸ\\&quot;,\\&quot;id\\&quot;:&quot; + requestId + &quot;}&quot;; } @PutMapping(&quot;/request&quot;) //@ResponseBody public String doPutRequest(Person person){ System.out.println(person.getName() + &quot;:&quot; + person.getAge()); return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®æ›´æ–°æˆåŠŸ\\&quot;}&quot;; } @DeleteMapping(&quot;/request&quot;) //@ResponseBody public String doDeleteRequest(){ return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®åˆ é™¤æˆåŠŸ\\&quot;}&quot;; } } 3.ç®€å•è¯·æ±‚ä¸éç®€å•è¯·æ±‚ ç®€å•è¯·æ±‚æ˜¯æŒ‡æ ‡å‡†ç»“æ„çš„HTTPè¯·æ±‚,å¯¹åº”GET/POSTè¯·æ±‚ éç®€å•è¯·æ±‚æ˜¯å¤æ‚è¦æ±‚çš„HTTPè¯·æ±‚,æŒ‡PUT/DELETEã€æ‰©å±•æ ‡å‡†è¯·æ±‚ ä¸¤è€…æœ€å¤§åŒºåˆ«æ˜¯éç®€å•è¯·æ±‚å‘é€å‰éœ€è¦å‘é€é¢„æ£€è¯·æ±‚ éç®€å•è¯·æ±‚ &lt;script&gt; $(function(){ $(&quot;#btnPost&quot;).click(function () { $.ajax({ url : &quot;/restful/request/100&quot;, type : &quot;post&quot; , data : &quot;name=lily&amp;age=23&quot;, dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message+&quot;:&quot;+json.id); } }) }); }) $(function(){ $(&quot;#btnPut&quot;).click(function () { $.ajax({ url : &quot;/restful/request&quot;, type : &quot;put&quot; , data : &quot;name=lily&amp;age=23&quot;, dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message); } }) }); }) &lt;/script&gt; @PostMapping(&quot;/request/{rid}&quot;) //@ResponseBody public String doPostRequest(@PathVariable(&quot;rid&quot;) Integer requestId, Person person){ System.out.println(person.getName() + &quot;:&quot; + person.getAge()); return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®æ–°å»ºæˆåŠŸ\\&quot;,\\&quot;id\\&quot;:&quot; + requestId + &quot;}&quot;; } @PutMapping(&quot;/request&quot;) //@ResponseBody public String doPutRequest(Person person){ System.out.println(person.getName() + &quot;:&quot; + person.getAge()); return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®æ›´æ–°æˆåŠŸ\\&quot;}&quot;; } ç”±äºPostè¯·æ±‚æ˜¯ç®€å•è¯·æ±‚,å¯ä»¥å¾—åˆ°æ‰§è¡Œç»“æœ lily:23 ä½†Putè¯·æ±‚æ˜¯éç®€å•è¯·æ±‚ï¼Œæ‰§è¡Œç»“æœ null:null ä¸ºäº†ä½¿éç®€å•è¯·æ±‚ï¼Œèƒ½å¤Ÿè·å–åˆ°æ•°æ®ã€‚éœ€è¦åœ¨web.xmlå¢åŠ é…ç½® &lt;!--web.xml--&gt; &lt;filter&gt; &lt;filter-name&gt;formContentFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.FormContentFilter&lt;/filter-class&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;formContentFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; 4.JSONåºåˆ—åŒ–public class Person { private String name; private Integer age; @JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot; , timezone = &quot;GMT+8&quot;) private Date birthday; public String getName() { return name; } public void setName(String name) { this.name = name; } public Integer getAge() { return age; } public void setAge(Integer age) { this.age = age; } public Date getBirthday() { return birthday; } public void setBirthday(Date birthday) { this.birthday = birthday; } } @JsonFormat(pattern = â€œyyyy-MM-dd HH:mm:ssâ€ , timezone = â€œGMT+8â€) å¯¹æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ–ï¼ŒJackSonçš„é»˜è®¤æ—¶åŒºä¸ºæ ¼æ—å°¼æ²»æ—¶é—´(GMT),åŒ—äº¬æ—¶é—´ä¸ºä¸œå…«åŒºã€‚éœ€è¦è¿›è¡Œè½¬æ¢æ—¶åŒºã€‚ @GetMapping(&quot;/person&quot;) public Person findByPersonId(Integer id){ Person p = new Person(); if(id==1){ p.setName(&quot;lily&quot;); p.setAge(23); }else if(id==2){ p.setName(&quot;smith&quot;); p.setAge(22); } return p; } @GetMapping(&quot;/persons&quot;) public List&lt;Person&gt; findPersons(){ List list = new ArrayList(); Person p1 = new Person(); p1.setName(&quot;lily&quot;); p1.setAge(23); p1.setBirthday(new Date()); Person p2 = new Person(); p2.setName(&quot;smith&quot;); p2.setAge(22); p2.setBirthday(new Date()); list.add(p1); list.add(p2); return list; } &lt;script&gt; $(function () { $(&quot;#btnPersons&quot;).click(function () { $.ajax({ url : &quot;/restful/persons&quot;, type : &quot;get&quot;, dataType : &quot;json&quot;, success : function(json){ console.info(json); for(var i = 0 ; i &lt; json.length;i++){ var p = json[i]; $(&quot;#divPersons&quot;).append(&quot;&lt;h2&gt;&quot; + p.name + &quot;-&quot; + p.age + &quot;-&quot; + p.birthday+ &quot;&lt;/h2&gt;&quot;) } } }) }) }) &lt;/script&gt; &lt;body&gt; &lt;h1 id=&quot;message&quot;&gt;&lt;/h1&gt; &lt;hr/&gt; &lt;input type=&quot;button&quot; id=&quot;btnPersons&quot; value=&quot;æŸ¥è¯¢æ‰€æœ‰äººå‘˜&quot;&gt; &lt;div id=&quot;divPersons&quot;&gt;&lt;/div&gt; &lt;/body&gt; 5.è·¨åŸŸè¯·æ±‚5.1 è·¨åŸŸåŸºç¡€çŸ¥è¯†æµè§ˆå™¨åŒæºç­–ç•¥ åŒæºç­–ç•¥é˜»æ­¢ä¸€ä¸ªåŸŸåŠ è½½çš„è„šæœ¬å»è·å–å¦ä¸€ä¸ªåŸŸä¸Šçš„èµ„æº åªè¦åè®®ã€åŸŸåã€ç«¯å£æœ‰ä¸€ä¸ªä¸åŒï¼Œéƒ½è¢«å½“ä½œæ˜¯ä¸åŒçš„åŸŸ æµè§ˆå™¨Consoleçœ‹åˆ° Access-Control-Allow-Originå°±ä»£è¡¨è·¨åŸŸäº† åŒæºç­–ç•¥ç¤ºä¾‹ HTMLä¸­å…è®¸è·¨åŸŸçš„æ ‡ç­¾ &lt;img&gt; - æ˜¾ç¤ºè¿œç¨‹å›¾ç‰‡ &lt;script&gt; - åŠ è½½è¿œç¨‹JS &lt;link&gt; - åŠ è½½è¿œç¨‹CSS ä¸ªäººç»å† å¹´å°‘æ—¶ç©çˆ¬è™«çš„æ—¶å€™ï¼Œç›®æ ‡æ˜¯ç›´æ¥çˆ¬å–Bç«™çš„æ•°æ®ï¼Œç›´æ¥æ˜¾ç¤ºåœ¨è‡ªå·±çš„ç•Œé¢ã€‚Bç«™æœ‰ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæ˜¯restfulé£æ ¼æä¾›æ•°æ®ã€‚é€šè¿‡å‰ç«¯ç›´æ¥å»Bç«™æœåŠ¡å™¨çš„Jsonæ•°æ®ã€‚ç»“æœå‘ç°ä¸€ç›´æ˜¯æ— æ³•æˆåŠŸè·å–ã€‚è¿™ä¸ªé—®é¢˜å°±æ˜¯åŒæºç­–ç•¥ã€‚åé¢è¿˜æ˜¯åªæœ‰é€šè¿‡åç«¯è¯­éŸ³æ‹¿åˆ°æ•°æ®å†ä¼ åˆ°å‰ç«¯ç¬é—´å®ç°ã€‚ CORSè·¨åŸŸèµ„æºè®¿é—® CORSæ˜¯ä¸€ç§æœºåˆ¶,ä½¿ç”¨é¢å¤–çš„HTTPå¤´é€šçŸ¥æµè§ˆå™¨å¯ä»¥è®¿é—®å…¶ä»–åŸŸï¼Œå…¶å®æ˜¯æµè§ˆå™¨å‘ç°æ˜¯è·¨åŸŸï¼Œæ‰€ä»¥è¿›è¡Œæ‹¦æˆªäº†ã€‚ URLå“åº”å¤´åŒ…å« Access-Control-*æŒ‡æ˜è¯·æ±‚å…è®¸è·¨åŸŸï¼Œæµè§ˆå™¨å‘ç°å¸¦æœ‰è¿™ä¸ªresponseå¤´ï¼Œå°±æ”¾è¡Œäº†ã€‚ è·¨åŸŸè®¿é—®ï¼Œåœ¨Request Headersä¸­ï¼Œæœ‰å­—æ®µSec-Fetch-Mode: cors5.2 Spring MVCè§£å†³è·¨åŸŸè®¿é—® @CrossOriginï¼ Controllerè·¨åŸŸæ³¨è§£ mvc:cors - Spring MVCå…¨å±€è·¨åŸŸé…ç½® @CrossOrigin`Java@RestController//æ›¿ä»£æ¯ä¸ª@ResponseBodyï¼Œä»£è¡¨æ˜¯restfulæ•°æ®è€Œä¸æ˜¯æ•°æ®è·³è½¬@RequestMapping(â€œ/restfulâ€)//@CrossOrigin(origins = {â€œhttp://localhost:8080&quot;,&quot;http://www.imooc.com&quot;})//@CrossOrigin(origins = â€œ*â€,maxAge = 3600)public class RestfulController { } åœ¨Controllerç±»ä¸Šæ·»åŠ æ³¨è§£ `@CrossOrigin(origins = {&quot;http://localhost:8080&quot;,&quot;http://www.imooc.com&quot;})` `@CrossOrigin(origins = &quot;*&quot;,maxAge = 3600)` maxAgeçš„æ„æ€æ˜¯æµè§ˆå™¨çš„éç®€å•è¯·æ±‚åœ¨å®é™…è¯·æ±‚ä¹‹å‰ï¼Œä¼šå…ˆå‘é€é¢„æ£€è¯·æ±‚ã€‚ maxAge å³ä¿å­˜é¢„ç®€è¯·æ±‚çš„æ—¶é—´ï¼Œåœ¨è¿™æœŸé—´ã€‚éç®€å•è¯·æ±‚å°±ä¸ç”¨å‘é€é¢„æ£€è¯·æ±‚äº†ï¼Œç¼“è§£æœåŠ¡å™¨çš„å‹åŠ›ã€‚ 2. &lt;mvc:cors&gt; ```Xml &lt;mvc:cors&gt; &lt;mvc:mapping path=&quot;/restful/**&quot; allowed-origins=&quot;http://localhost:8080,http://www.imooc.com&quot; max-age=&quot;3600&quot;/&gt; &lt;/mvc:cors&gt; å…¶ä¸­ path=&quot;/restful/** è¡¨ç¤ºè®¿é—®çš„ç›®æ ‡åŸŸåä¸ºrestful/ ä¸‹çš„æ‰€æœ‰åŸŸå æ€»ç»“ mvc:cors çš„ä¼˜åŠ¿æ–¹ä¾¿é…ç½®å…¨å±€è·¨åŸŸè®¿é—®ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Spring MVC","slug":"Spring-MVC","permalink":"/tags/Spring-MVC/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Spring MVC","slug":"æŠ€æœ¯/Spring MVC","date":"2020-10-18T13:00:00.000Z","updated":"2020-10-19T17:49:49.689Z","comments":true,"path":"2020/10/18/æŠ€æœ¯/Spring MVC/","link":"","permalink":"/2020/10/18/æŠ€æœ¯/Spring MVC/","excerpt":"","text":"1.ç¯å¢ƒé…ç½®&lt;!--web.xml--&gt; &lt;servlet&gt; &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt; &lt;!-- DispatcherServletæ˜¯Spring MVCæœ€æ ¸å¿ƒçš„å¯¹è±¡ DispatcherServletç”¨äºæ‹¦æˆªHttpè¯·æ±‚, å¹¶æ ¹æ®è¯·æ±‚çš„URLè°ƒç”¨ä¸ä¹‹å¯¹åº”çš„Controlleræ–¹æ³•,æ¥å®ŒæˆHttpè¯·æ±‚çš„å¤„ç† --&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;!--applicationContext.xml--&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;!-- åœ¨Webåº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºSpring IOCå®¹å™¨, å¹¶åˆå§‹åŒ–DispatcherServlet --&gt; &lt;load-on-startup&gt;0&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt; &lt;!--&quot;/&quot; ä»£è¡¨æ‹¦æˆªæ‰€æœ‰è¯·æ±‚--&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mv=&quot;http://www.springframework.org/schema/mvc&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt; &lt;!-- context:component-scan æ ‡ç­¾ä½œç”¨ åœ¨Spring IOCåˆå§‹åŒ–è¿‡ç¨‹ä¸­,è‡ªåŠ¨åˆ›å»ºå¹¶ç®¡ç†com.imooc.springmvcåŠå­åŒ…ä¸­ æ‹¥æœ‰ä»¥ä¸‹æ³¨è§£çš„å¯¹è±¡. @Repository @Service @Controller @Component --&gt; &lt;context:component-scan base-package=&quot;com.imooc.springmvc&quot;&gt;&lt;/context:component-scan&gt; &lt;!--1.å¯ç”¨Spring MVCçš„æ³¨è§£å¼€å‘æ¨¡å¼--&gt; &lt;mvc:annotation-driven conversion-service=&quot;conversionService&quot;&gt; &lt;/mvc:annotation-driven&gt; &lt;!-- å°†å›¾ç‰‡/JS/CSSç­‰é™æ€èµ„æºæ’é™¤åœ¨å¤–,å¯æé«˜æ‰§è¡Œæ•ˆç‡ --&gt; &lt;mvc:default-servlet-handler/&gt; 2.URL Mappingæ³¨è§£ä½œç”¨URL Mappingå°†URLä¸Controlleræ–¹æ³•è¿›è¡Œç»‘å®š RequestMapping - é€šç”¨ç»‘å®š GetMaping - ç»‘å®šGetè¯·æ±‚ PostMapping - ç»‘å®šPostè¯·æ±‚ å‰ç«¯Post è¯·æ±‚ &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;form action=&quot;/um/p1&quot; method=&quot;post&quot;&gt; &lt;input name=&quot;username&quot;&gt; &lt;br&gt; &lt;input name=&quot;password&quot;&gt; &lt;br&gt; &lt;input name=&quot;createTime&quot;&gt; &lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot;&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; @Controller @RequestMapping(&quot;/um&quot;) //ä¸ºæ‰€æœ‰ç±»çš„æ˜ å°„éƒ½æ·»åŠ ä¸€ä¸ªå‰ç¼€ public class URLMappingController { @GetMapping(&quot;/g&quot;) @ResponseBody //manager_nameå‚æ•°æ˜ å°„åˆ°String managerName //Date createTime æ˜¯ä½¿ç”¨MyDateConverterç±»åœ¨applicationContext.xmlé…ç½®è¿›è¡Œæ—¥æœŸè½¬æ¢çš„ public String getMapping(@RequestParam(&quot;manager_name&quot;) String managerName,Date createTime){ System.out.println(&quot;managerName:&quot; + managerName); System.out.println(createTime); return &quot;This is get method&quot;; } @PostMapping(&quot;/p&quot;) @ResponseBody public String postMapping(String username, Long password) { System.out.println(username + &quot;:&quot; + password); return &quot;This is post method&quot;; } @PostMapping(&quot;/p1&quot;) @ResponseBody //1.å¯ä»¥ç”¨å¯¹è±¡Userè¿›è¡Œæ¥æ”¶Postå‚æ•°ï¼Œå…¶ä¸­createTimeå­—æ®µï¼Œåœ¨Userç±»ä¸­ï¼Œéœ€è¦ä½¿ç”¨DateTimeFormat //2.å•ç‹¬æ¥æ”¶createTime æ—¶ï¼Œä¹Ÿå¯ä»¥å½¢å¼å‚æ•°ä¸­@DateTimeFormatï¼ŒæŒ‡æ˜æ ¼å¼ //3.String usernameä¹Ÿå¯ä»¥æ¥æ”¶åˆ°æ•°æ® public String postMapping(User user, String username, @DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) Date createTime) { System.out.println(user.getUsername() + &quot;:&quot; + user.getPassword()); System.out.println(&quot;date:&quot; + user.getCreateTime()); return &quot;&lt;h1&gt;è¿™æ˜¯Postå“åº”&lt;/h1&gt;&quot;; } } public class User { private String username; private Long password; @DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) private Date createTime; public String getUsername() { return username; } public void setUsername(String username) { this.username = username; } public Long getPassword() { return password; } public void setPassword(Long password) { this.password = password; } public Date getCreateTime() { return createTime; } public void setCreateTime(Date createTime) { this.createTime = createTime; } } 3.æ¥æ”¶è¡¨å•å¤æ‚æ•°æ®&lt;div class=&quot;container&quot;&gt; &lt;h2&gt;å­¦å‘˜è°ƒæŸ¥é—®å·&lt;/h2&gt; &lt;form action=&quot;./apply&quot; method=&quot;post&quot;&gt; &lt;h3&gt;æ‚¨çš„å§“å&lt;/h3&gt; &lt;input name=&quot;name&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;h3&gt;æ‚¨æ­£åœ¨å­¦ä¹ çš„æŠ€æœ¯æ–¹å‘&lt;/h3&gt; &lt;select name=&quot;course&quot; style=&quot;width: 150px&quot;&gt; &lt;option value=&quot;java&quot;&gt;Java&lt;/option&gt; &lt;option value=&quot;h5&quot;&gt;HTML5&lt;/option&gt; &lt;option value=&quot;python&quot;&gt;Python&lt;/option&gt; &lt;option value=&quot;php&quot;&gt;PHP&lt;/option&gt; &lt;/select&gt; &lt;div&gt; &lt;h3&gt;æ‚¨çš„å­¦ä¹ ç›®çš„ï¼š&lt;/h3&gt; &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;1&quot;&gt;å°±ä¸šæ‰¾å·¥ä½œ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;2&quot;&gt;å·¥ä½œè¦æ±‚ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;3&quot;&gt;å…´è¶£çˆ±å¥½ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;4&quot;&gt;å…¶ä»– &lt;/div&gt; &lt;div style=&quot;text-align: center;padding-top:10px&quot; &gt; &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot; style=&quot;width:100px&quot;&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; @Controller public class FormContoller { @PostMapping(&quot;/apply&quot;) @ResponseBody //1.@RequestParam æŒ‡å®šæ¥æ”¶åˆ°çš„å‚æ•°ä¸ºn,é»˜è®¤å€¼ä¸º&quot;ANON&quot;,å¯é¿å…æ— æ³•åŒ¹é…åˆ°å‚æ•°æ—¶ï¼Œå‡ºç°çš„å¼‚å¸¸ //2.å¤é€‰æ¡†ä½¿ç”¨æ•°ç»„Integer[] purposeï¼Œæ¥æ”¶ public String apply(@RequestParam(value = &quot;n&quot;, defaultValue = &quot;ANON&quot;) String name, String course, Integer[] purpose) { System.out.println(&quot;name:&quot; + name); System.out.println(&quot;course:&quot; + course); for(Integer p : purpose){ System.out.println(&quot;purpose:&quot; + p); } return &quot;SUCCES&quot;; } // @PostMapping(&quot;/apply&quot;) @ResponseBody //@RequestParamè¡¨ç¤ºå°†æ¥æ”¶åˆ°çš„æ•°æ®è½¬æ¢æˆListï¼Œä¸€å®šè¦åŠ  public String apply(String name, String course, @RequestParam List&lt;Integer&gt; purpose){ System.out.println(&quot;name:&quot; + name); System.out.println(&quot;course:&quot; + course); for(Integer p : purpose){ System.out.println(&quot;purpose:&quot; + p); } return &quot;SUCCES&quot;; } // @PostMapping(&quot;/apply&quot;) @ResponseBody //ä»¥å¯¹è±¡æ–¹å¼æ¥æ”¶å‚æ•° public String apply(Form form) { System.out.println(form.getName()); System.out.println(form.getCourse()); for(Integer p : form.getPurpose()) { System.out.println(p); } return &quot;SUCCESS&quot;; } // @PostMapping(&quot;/apply&quot;) @ResponseBody //æ³¨æ„Mapç±»å‹æœ€å¥½ä¸è¦ç”¨å› ä¸ºMapç±»å‹å¯¹äºä¼ è¿‡æ¥çš„purposeå‚æ•°ï¼Œå¯¹äºå¤æ‚ç±»å‹ï¼Œå¦‚å¤é€‰æ¡†ï¼Œåªä¼šå–ç¬¬ä¸€ä¸ªå€¼ã€‚æ¼æ‰æ•°æ® public String apply(@RequestParam Map map){ System.out.println(map); return &quot;SUCCESS&quot;; } } public class Form { private String name; private String course; private List&lt;Integer&gt; purpose; public String getName() { return name; } public void setName(String name) { this.name = name; } public String getCourse() { return course; } public void setCourse(String course) { this.course = course; } public List&lt;Integer&gt; getPurpose() { return purpose; } public void setPurpose(List&lt;Integer&gt; purpose) { this.purpose = purpose; } } 4.å…³è”å¯¹è±¡èµ‹å€¼ &lt;h2&gt;å­¦å‘˜è°ƒæŸ¥é—®å·&lt;/h2&gt; &lt;form action=&quot;./apply&quot; method=&quot;post&quot;&gt; &lt;h3&gt;æ‚¨çš„å§“å&lt;/h3&gt; &lt;input name=&quot;name&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;h3&gt;æ‚¨æ­£åœ¨å­¦ä¹ çš„æŠ€æœ¯æ–¹å‘&lt;/h3&gt; &lt;select name=&quot;course&quot; style=&quot;width: 150px&quot;&gt; &lt;option value=&quot;java&quot;&gt;Java&lt;/option&gt; &lt;option value=&quot;h5&quot;&gt;HTML5&lt;/option&gt; &lt;option value=&quot;python&quot;&gt;Python&lt;/option&gt; &lt;option value=&quot;php&quot;&gt;PHP&lt;/option&gt; &lt;/select&gt; &lt;div&gt; &lt;h3&gt;æ‚¨çš„å­¦ä¹ ç›®çš„ï¼š&lt;/h3&gt; &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;1&quot;&gt;å°±ä¸šæ‰¾å·¥ä½œ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;2&quot;&gt;å·¥ä½œè¦æ±‚ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;3&quot;&gt;å…´è¶£çˆ±å¥½ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;4&quot;&gt;å…¶ä»– &lt;/div&gt; &lt;h3&gt;æ”¶è´§äºº&lt;/h3&gt; &lt;input name=&quot;delivery.name&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;h3&gt;è”ç³»ç”µè¯&lt;/h3&gt; &lt;input name=&quot;delivery.mobile&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;h3&gt;æ”¶è´§åœ°å€&lt;/h3&gt; &lt;input name=&quot;delivery.address&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;div style=&quot;text-align: center;padding-top:10px&quot; &gt; &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot; style=&quot;width:100px&quot;&gt; &lt;/div&gt; &lt;/form&gt; delivery.name delivery.mobile delivery.address public class Delivery { private String name; private String address; private String mobile; public String getName() { return name; } public void setName(String name) { this.name = name; } public String getAddress() { return address; } public void setAddress(String address) { this.address = address; } public String getMobile() { return mobile; } public void setMobile(String mobile) { this.mobile = mobile; } } public class Form { private String name; private String course; private List&lt;Integer&gt; purpose; private Delivery delivery = new Delivery();//å…³è”å¯¹è±¡ public Delivery getDelivery() { return delivery; } public void setDelivery(Delivery delivery) { this.delivery = delivery; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getCourse() { return course; } public void setCourse(String course) { this.course = course; } public List&lt;Integer&gt; getPurpose() { return purpose; } public void setPurpose(List&lt;Integer&gt; purpose) { this.purpose = purpose; } } @PostMapping(&quot;/apply&quot;) @ResponseBody //æ³¨æ„Mapç±»å‹æœ€å¥½ä¸è¦ç”¨å› ä¸ºMapç±»å‹å¯¹äºä¼ è¿‡æ¥çš„purposeå‚æ•°ï¼Œåªä¼šå–ç¬¬ä¸€ä¸ª public String applyDelivery(Form form){ System.out.println(form.getDelivery().getName()); return &quot;SUCCESS&quot;; } 5.æ—¥æœŸè½¬æ¢ @DateTimeFormatæŒ‡å®šæ ¼å¼ï¼Œå°†String ç±»å‹è½¬æ¢ç§°æ—¥æœŸç±»å‹ @PostMapping(&quot;/p1&quot;) @ResponseBody //1.å¯ä»¥ç”¨å¯¹è±¡Userè¿›è¡Œæ¥æ”¶Postå‚æ•°ï¼Œå…¶ä¸­createTimeå­—æ®µï¼Œåœ¨Userç±»ä¸­ï¼Œéœ€è¦ä½¿ç”¨DateTimeFormat //2.å•ç‹¬æ¥æ”¶createTime æ—¶ï¼Œä¹Ÿå¯ä»¥å½¢å¼å‚æ•°ä¸­@DateTimeFormatï¼ŒæŒ‡æ˜æ ¼å¼ public String postMapping(User user, String username, @DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) Date createTime) { System.out.println(user.getUsername() + &quot;:&quot; + user.getPassword()); System.out.println(&quot;date:&quot; + user.getCreateTime()); return &quot;&lt;h1&gt;è¿™æ˜¯Postå“åº”&lt;/h1&gt;&quot;; } å¯¹è±¡æˆå‘˜ æ³¨è§£ public class User { private String username; private Long password; //@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) private Date createTime; public String getUsername() { return username; } public void setUsername(String username) { this.username = username; } public Long getPassword() { return password; } public void setPassword(Long password) { this.password = password; } public Date getCreateTime() { return createTime; } public void setCreateTime(Date createTime) { this.createTime = createTime; } } public String postMapping(User user, String username, @DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) Date createTime) { System.out.println(user.getUsername() + &quot;:&quot; + user.getPassword()); System.out.println(&quot;date:&quot; + user.getCreateTime()); return &quot;&lt;h1&gt;è¿™æ˜¯Postå“åº”&lt;/h1&gt;&quot;; } User å¯¹è±¡çš„æˆå‘˜å˜é‡è‡ªåŠ¨è½¬æ¢ è‡ªå®šä¹‰æ—¥æœŸè½¬æ¢ç±» //æ—¥æœŸè½¬æ¢ public class MyDateConverter implements Converter&lt;String, Date&gt; { public Date convert(String s) { SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); try { Date d = sdf.parse(s); return d; } catch (ParseException e) { return null; } } } &lt;!--applicationContext.xml--&gt; &lt;mvc:annotation-driven conversion-service=&quot;conversionService&quot;&gt;&lt;/mvc:annotation-driven&gt; &lt;bean id=&quot;conversionService&quot; class=&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;&gt; &lt;property name=&quot;converters&quot;&gt; &lt;set&gt; &lt;!--æŒ‡å®šæ—¥æœŸè½¬æ¢ç±»--&gt; &lt;bean class=&quot;com.imooc.springmvc.converter.MyDateConverter&quot;/&gt; &lt;/set&gt; &lt;/property&gt; &lt;/bean&gt; @GetMapping(&quot;/g&quot;) @ResponseBody //manager_nameå‚æ•°æ˜ å°„åˆ°String managerName //Date createTime æ˜¯ä½¿ç”¨MyDateConverterç±»åœ¨applicationContext.xmlé…ç½®è¿›è¡Œæ—¥æœŸè½¬æ¢çš„ public String getMapping(@RequestParam(&quot;manager_name&quot;) String managerName,Date createTime){ System.out.println(&quot;managerName:&quot; + managerName); System.out.println(createTime); return &quot;This is get method&quot;; } Date createTime æ²¡æœ‰åŠ æ³¨è§£ï¼Œä¹Ÿå¯ä»¥è½¬æ¢ æ³¨æ„ï¼šæ³¨è§£ä¸è‡ªå®šä¹‰æ—¥æœŸè½¬æ¢ç±»åŒæ—¶å­˜åœ¨æ—¶ï¼Œä»¥æ—¥æœŸè½¬æ¢ç±»ä¼˜å…ˆ 6.ä¸­æ–‡ä¹±ç é—®é¢˜ Getä¹±ç é—®é¢˜ - server.xmlå¢åŠ URIEncodingå±æ€§ Postè¯·æ±‚ä¹±ç  - Web.xml é…ç½® CharacterEncodingFilter Responseå“åº”ä¹±ç  - springé…ç½®StringHttpMessageConverter 6.1 getPath:â€Tomcat v8.5 Server at localhost-config\\server.xmlâ€ &lt;Connector connectionTimeout=&quot;20000&quot; port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; redirectPort=&quot;8443&quot; URIEncoding=&quot;UTF-8&quot;/&gt; åœ¨tomcat8 ä»¥ä¸‹çš„ç‰ˆæœ¬éœ€è¦å¢åŠ URIEncodingï¼Œä»¥ä¸Šç‰ˆæœ¬é»˜è®¤æ˜¯UTF-8 6.2 posté€šè¿‡è¿‡æ»¤å™¨æ¥å®ç°postç¼–ç  &lt;!--web.xml--&gt; &lt;filter&gt; &lt;filter-name&gt;characterFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;characterFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; 6.3 Response&lt;!--applicationContext.xml--&gt; &lt;!--3.message-converters é…ç½®Responseå“åº”å­—ç¬¦é›†--&gt; &lt;mvc:annotation-driven conversion-service=&quot;conversionService&quot;&gt; &lt;mvc:message-converters&gt; &lt;bean class=&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;&gt; &lt;property name=&quot;supportedMediaTypes&quot;&gt; &lt;list&gt; &lt;!-- response.setContentType(&quot;text/html;charset=utf-8&quot;) --&gt; &lt;value&gt;text/plain;charset=utf-8&lt;/value&gt; &lt;value&gt;text/html;charset=utf-8&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/mvc:message-converters&gt; &lt;/mvc:annotation-driven&gt; 7.å“åº”è¾“å‡º7.1 ModelAndView","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Spring MVC","slug":"Spring-MVC","permalink":"/tags/Spring-MVC/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Spring äº‹åŠ¡ç®¡ç†","slug":"æŠ€æœ¯/Spring äº‹åŠ¡ç®¡ç†","date":"2020-10-18T07:00:00.000Z","updated":"2020-10-18T07:46:40.308Z","comments":true,"path":"2020/10/18/æŠ€æœ¯/Spring äº‹åŠ¡ç®¡ç†/","link":"","permalink":"/2020/10/18/æŠ€æœ¯/Spring äº‹åŠ¡ç®¡ç†/","excerpt":"","text":"ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ äº‹åŠ¡ä¸€èˆ¬æŒ‡çš„æ˜¯æ•°æ®åº“äº‹åŠ¡(Database Transaction),æ˜¯æŒ‡ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒï¼Œè¦ä¹ˆå®Œå…¨æ‰§è¡Œï¼Œè¦ä¹ˆå®Œå…¨ä¸æ‰§è¡Œ äº‹åŠ¡å¹¶å‘é—®é¢˜ è„è¯» è§£å†³æ–¹æ³•ï¼šåªèƒ½è¯»å–æ°¸ä¹…æ•°æ®ï¼Œä¸èƒ½è¯»å–å†…å­˜ä¸­çš„æ•°æ® ä¸å¯é‡å¤è¯» è§£å†³æ–¹æ³•ï¼šé”è¡Œ å¹»è¯» è§£å†³æ–¹æ³•ï¼šé”è¡¨ Mysqläº‹åŠ¡éš”ç¦»çº§åˆ« JDBCäº‹åŠ¡éš”ç¦»çº§åˆ« äº‹åŠ¡ä¼ æ’­è¡Œä¸º 0. å…¬å…±ä»£ç &lt;!--spring-dao.xml--&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/os?useUnicode=true&amp;amp;characterEncoding=utf-8&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;foreverlove&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;jdbcTemplate&quot; class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--åœ¨ XML é…ç½®æ–‡ä»¶ä¸­å¯åŠ¨ Spring çš„è‡ªåŠ¨æ‰«æåŠŸèƒ½ æˆ‘ä»¬å°±ä¸å†éœ€è¦åœ¨ XML ä¸­æ˜¾å¼ä½¿ç”¨ &lt;bean/&gt; è¿›è¡ŒBean çš„é…ç½®ã€‚ Spring åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶å°†è‡ªåŠ¨æ‰«æ com.imooc.os.dao æŒ‡å®šçš„åŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰ classæ–‡ä»¶ï¼Œ æ‰€æœ‰æ ‡æ³¨äº† @Repository çš„ç±»éƒ½å°†è¢«æ³¨å†Œä¸º Spring Beanã€‚ --&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.dao&quot;/&gt; &lt;/beans&gt; @Repository public class OrderDaoImpl implements OrderDao { @Autowired private JdbcTemplate jdbcTemplate; public void insert(Order order) { String sql = &quot;insert into orders values(?,?,?,?,?,?,?,?,?,?,?)&quot;; jdbcTemplate.update(sql,order.getId(),order.getProductsId(),order.getNumber(),order.getPrice(),order.getCreateTime(),order.getSendTime(),order.getConfirmTime(),order.getConsignee(),order.getConsigneePhone(),order.getConsigneeAddress(),order.getStatus()); } public void update(Order order) { String sql = &quot;update orders set create_time=?,send_time=?,confirm_time=?,consignee=?,consignee_phone=?,consignee_address=?,status=? where id=?&quot;; jdbcTemplate.update(sql,order.getProductsId(),order.getNumber(),order.getPrice(),order.getCreateTime(),order.getSendTime(),order.getConfirmTime(),order.getConsignee(),order.getConsigneePhone(),order.getConsigneeAddress(),order.getStatus(),order.getId()); } public void delete(String id) { String sql = &quot;delete from orders where id=?&quot;; jdbcTemplate.update(sql,id); } public Order select(String id) { String sql = &quot;select form orders where id=?&quot;; return jdbcTemplate.queryForObject(sql,new OrderRowMapper(),id); } public List&lt;Order&gt; select() { String sql = &quot;select form orders&quot;; return jdbcTemplate.query(sql,new OrderRowMapper()); } private class OrderRowMapper implements RowMapper&lt;Order&gt;{ public Order mapRow(ResultSet resultSet, int i) throws SQLException { Order order=new Order(); order.setId(resultSet.getString(&quot;id&quot;)); order.setProductsId(resultSet.getString(&quot;product_id&quot;)); order.setNumber(resultSet.getInt(&quot;number&quot;)); order.setPrice(resultSet.getDouble(&quot;price&quot;)); order.setCreateTime(resultSet.getTimestamp(&quot;create_time&quot;)); order.setSendTime(resultSet.getTimestamp(&quot;send_time&quot;)); order.setConfirmTime(resultSet.getTimestamp(&quot;confirm_time&quot;)); order.setConsignee(resultSet.getString(&quot;consignee&quot;)); order.setConsigneePhone(resultSet.getString(&quot;consignee_phone&quot;)); order.setConsigneeAddress(resultSet.getString(&quot;consignee_address&quot;)); order.setStatus(resultSet.getString(&quot;status&quot;)); return order; } } } @Repository public class ProductDaoImpl implements ProductDao { @Autowired private JdbcTemplate jdbcTemplate; public void insert(Product product) { String sql = &quot;insert into products values(?,?,?,?,?)&quot;; jdbcTemplate.update(sql,product.getId(),product.getTitle(),product.getPrice(),product.getStock(),product.getStatus()); } public void update(Product product) { String sql = &quot;update products set title=?,price=?,stock=?,status=? where id=?&quot;; jdbcTemplate.update(sql,product.getTitle(),product.getPrice(),product.getStock(),product.getStatus(),product.getId()); } public void delete(String id) { String sql = &quot;delete form products where id=?&quot;; jdbcTemplate.update(sql,id); } public Product select(String id) { String sql = &quot;select * from products where id=?&quot;; return jdbcTemplate.queryForObject(sql,new ProductRowMapper(),id); } public List&lt;Product&gt; select() { String sql = &quot;select * from products&quot;; return jdbcTemplate.query(sql,new ProductRowMapper()); } private class ProductRowMapper implements RowMapper&lt;Product&gt;{ public Product mapRow(ResultSet resultSet, int i) throws SQLException { Product product = new Product(); product.setId(resultSet.getString(&quot;id&quot;)); product.setTitle(resultSet.getString(&quot;title&quot;)); product.setPrice(resultSet.getDouble(&quot;price&quot;)); product.setStock(resultSet.getInt(&quot;stock&quot;)); product.setStatus(resultSet.getString(&quot;status&quot;)); return product; } } } 1.Springç¼–ç¨‹å¼äº‹ç‰©å¤„ç†1.1 æ–¹å¼1 åŸºäºåº•å±‚APIçš„ç¼–ç¨‹å¼äº‹ç‰©å¤„ç† PlatformTransactionManager TransactionDefinition TransactionStatus &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.service.impl1&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;transactionDefinition&quot; class=&quot;org.springframework.transaction.support.DefaultTransactionDefinition&quot;&gt; &lt;property name=&quot;propagationBehaviorName&quot; value=&quot;PROPAGATION_REQUIRED&quot;/&gt; &lt;!--PROPAGATION_REQUIRED è¡¨ç¤º äº‹åŠ¡ä¼ æ’­è¡Œä¸º--æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœæ²¡æœ‰å½“å‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡--&gt; &lt;!--ä¹Ÿå¯é…ç½®éš”ç¦»çº§åˆ«ç­‰å…¶ä»–å±æ€§ï¼Œä¸é…ç½®å³ä½¿ç”¨é»˜è®¤--&gt; &lt;/bean&gt; &lt;/beans&gt; package com.imooc.os.service; import com.imooc.os.entity.Order; public interface OrderService { void addOrder(Order order); } /*1.åŸºäºåº•å±‚APIçš„æ–¹å¼ PlatformTransactionManager TransactionDefinition*/ @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; @Autowired private PlatformTransactionManager transactionManager; @Autowired private TransactionDefinition transactionDefinition; public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); //å¼€å¯äº‹åŠ¡ TransactionProxyFactoryBean transactionProxyFactoryBean; TransactionStatus transactionStatus = transactionManager.getTransaction(transactionDefinition); try { orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); //ç»“æŸäº‹åŠ¡ transactionManager.commit(transactionStatus); }catch (Exception e){ e.printStackTrace(); //å‡ºé—®é¢˜ï¼Œå°†æœªæäº¤çš„sqlå›æ»š transactionManager.rollback(transactionStatus); } } } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service1.xml&quot;) //1.åŸºäºåº•å±‚apiçš„ç¼–ç¨‹å¼äº‹åŠ¡å¤„ç†æ–¹å¼ public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 1.2 åŸºäºTransactionTemplateçš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç† TransactionTemplate &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.service.impl2&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;transactionTemplate&quot; class=&quot;org.springframework.transaction.support.TransactionTemplate&quot;&gt; &lt;property name=&quot;transactionManager&quot; ref=&quot;transactionManager&quot;/&gt; &lt;/bean&gt; &lt;/beans&gt; //2.åŸºäºTransactionTemplateçš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç† @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; //2.TransactionTemplate ç”¨äºç®€åŒ–åº•å±‚API @Autowired private TransactionTemplate transactionTemplate; public void addOrder(final Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); transactionTemplate.execute(new TransactionCallback() { public Object doInTransaction(TransactionStatus transactionStatus) { try { orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); //ä¸éœ€è¦æäº¤ï¼ŒTransactionTemplateä¼šå¸®ä½ æäº¤ }catch (Exception e){ e.printStackTrace(); transactionStatus.setRollbackOnly();//å›æ»š } return null; } }); } } public interface OrderService { void addOrder(Order order); } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service2.xml&quot;) //2.åŸºäºTransactionTemplateçš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç† public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 2.Springå£°æ˜å¼äº‹åŠ¡å¤„ç†ç®€ä»‹ Springçš„å£°æ˜å¼äº‹åŠ¡å¤„ç†æ˜¯å»ºç«‹åœ¨AOPçš„åŸºç¡€ä¹‹ä¸Šçš„ã€‚å…¶æœ¬è´¨æ˜¯å¯¹æ–¹æ³•å‰åè¿›è¡Œæ‹¦æˆªï¼Œç„¶ååœ¨ç›®æ ‡æ–¹æ³•å¼€å§‹ä¹‹å‰åˆ›å»ºæˆ–åŠ ä¸€ä¸ªäº‹åŠ¡ï¼Œåœ¨æ‰§è¡Œå®Œç›®æ ‡æ–¹æ³•ä¹‹åæ ¹æ®æ‰§è¡Œæƒ…å†µæäº¤æˆ–è€…å›æ»šäº‹åŠ¡ã€‚ å»ºè®®åœ¨å¼€å‘ä¸­ä½¿ç”¨å£°æ˜å¼äº‹åŠ¡ï¼Œä½¿å¾—ä¸šåŠ¡ä»£ç çº¯ç²¹å¹²å‡€ï¼Œæ–¹ä¾¿åæœŸä»£ç ç»´æŠ¤ åˆ†ç±» åŸºäºTransactionInterceptorçš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ã€‚ åŸºäºTransactionProxyFactoryBeançš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ã€‚ åŸºäº å‘½åç©ºé—´çš„å£°æ˜å¼äº‹ç‰©ç®¡ç†ã€‚ åŸºäº @Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€‚ 2.1 åŸºäºTransactionInterceptorçš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ã€‚&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--1.åŸºäºTransactionInterceptorçš„å£°æ˜å¼äº‹åŠ¡å¤„ç†--&gt; &lt;bean id=&quot;orderServiceTarget&quot; class=&quot;com.imooc.os.service.impl.OrderServiceImpl&quot;/&gt; &lt;bean id=&quot;transactionInterceptor&quot; class=&quot;org.springframework.transaction.interceptor.TransactionInterceptor&quot;&gt; &lt;!--é…ç½®äº‹åŠ¡ç®¡ç†å™¨--&gt; &lt;property name=&quot;transactionManager&quot; ref=&quot;transactionManager&quot;/&gt; &lt;!--é…ç½®æ‹¦æˆªå™¨--&gt; &lt;property name=&quot;transactionAttributes&quot;&gt; &lt;props&gt; &lt;!--keyæ˜¯æ–¹æ³•ï¼Œé…ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œå±æ€§--&gt; &lt;prop key=&quot;get*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;find*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;search*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;/bean&gt; &lt;!--ç”¨æ‹¦æˆªå™¨å¢å¼ºç›®æ ‡ç±»ï¼Œå»ºç«‹å…³è”--&gt; &lt;bean id=&quot;orderService&quot; class=&quot;org.springframework.aop.framework.ProxyFactoryBean&quot;&gt; &lt;property name=&quot;target&quot; ref=&quot;orderServiceTarget&quot;/&gt; &lt;property name=&quot;interceptorNames&quot;&gt; &lt;list&gt; &lt;idref bean=&quot;transactionInterceptor&quot;/&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/beans&gt; @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); } } å¯¹äºaddOrderï¼Œç”±äºæ‹¦æˆªå™¨å¢å¼ºï¼Œå‡ºé”™æ—¶ï¼Œè¿™ä¸ªå‡½æ•°çš„æ“ä½œè‡ªåŠ¨å›æ»šã€‚ @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service3.xml&quot;) //3.åŸºäºTransactionInterceptorçš„å£°æ˜å¼äº‹åŠ¡å¤„ç† public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 2.2 åŸºäºTransactionProxyFactoryBeançš„å£°æ˜å¼äº‹åŠ¡å¤„ç†&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--2.åŸºäºTransactionProxyFactoryBeançš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ï¼Œå…¶å®å°±æ˜¯ç®€åŒ–ä¸Šé¢çš„é‚£ç§æ‹¦æˆªå™¨--&gt; &lt;bean id=&quot;orderServiceTarget&quot; class=&quot;com.imooc.os.service.impl.OrderServiceImpl&quot;/&gt; &lt;bean id=&quot;orderService&quot; class=&quot;org.springframework.transaction.interceptor.TransactionProxyFactoryBean&quot;&gt; &lt;property name=&quot;transactionManager&quot; ref=&quot;transactionManager&quot;/&gt; &lt;property name=&quot;transactionAttributes&quot;&gt; &lt;props&gt; &lt;prop key=&quot;get*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;find*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;search*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;property name=&quot;target&quot; ref=&quot;orderServiceTarget&quot;/&gt; &lt;/bean&gt; &lt;/beans&gt; @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); } } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service4.xml&quot;) //4.åŸºäºTransactionProxyFactoryBeançš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ï¼Œå…¶å®å°±æ˜¯ç®€åŒ–ä¸Šé¢çš„é‚£ç§æ‹¦æˆªå™¨ public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 2.3 (æœ€æ¨è)åŸºäº å‘½åç©ºé—´çš„å£°æ˜å¼äº‹ç‰©ç®¡ç†ã€‚&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.service.impl&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--3.åŸºäº&lt;tx&gt;å‘½åç©ºé—´çš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ï¼Œè¿™ç§æ˜¯å®é™…å¼€å‘å¸¸ç”¨çš„--&gt; &lt;!--å¢åŠ é€šçŸ¥--&gt; &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt; &lt;tx:attributes&gt; &lt;tx:method name=&quot;get*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt; &lt;tx:method name=&quot;find*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt; &lt;tx:method name=&quot;search*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt; &lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot;/&gt; &lt;/tx:attributes&gt; &lt;/tx:advice&gt; &lt;!--å¢å¼ºçš„åœ°æ–¹,åœ¨å“ªä¸ªæ–¹æ³•å¢å¼º--&gt; &lt;aop:config&gt; &lt;aop:pointcut id=&quot;pointcut&quot; expression=&quot;execution(* com.imooc.os.service.impl.*.*(..))&quot;/&gt; &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;pointcut&quot;/&gt; &lt;/aop:config&gt; &lt;/beans&gt; @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); } } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service5.xml&quot;) //5.åŸºäº&lt;tx&gt;å‘½åç©ºé—´çš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ï¼Œè¿™ç§æ˜¯å®é™…å¼€å‘å¸¸ç”¨çš„ public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 2.4 åŸºäº @Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€‚&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.service.impl6&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--4.åŸºäº@Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†--&gt; &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt; &lt;/beans&gt; @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; //4.åŸºäº@Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç† @Transactional(propagation = Propagation.REQUIRED) public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); } } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service6.xml&quot;) //6.åŸºäº@Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†,è¿™ç§æ˜¯å®é™…å¼€å‘å¸¸ç”¨çš„ public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"spring","slug":"spring","permalink":"/tags/spring/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"JDBC Template","slug":"æŠ€æœ¯/JDBC Template","date":"2020-10-17T06:00:00.000Z","updated":"2020-10-18T07:37:07.724Z","comments":true,"path":"2020/10/17/æŠ€æœ¯/JDBC Template/","link":"","permalink":"/2020/10/17/æŠ€æœ¯/JDBC Template/","excerpt":"","text":"1.JDBC Templateç®€ä»‹Springå¯¹æ•°æ®åº“çš„æ“ä½œåœ¨jdbcä¸Šé¢åšäº†æ·±å±‚æ¬¡çš„å°è£…ï¼Œä½¿ç”¨springçš„æ³¨å…¥åŠŸèƒ½ï¼Œå¯ä»¥æŠŠDataSourceæ³¨å†Œåˆ°JdbcTemplateä¹‹ä¸­ã€‚ 2.codespring.xml &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/selection_course?useUnicode=true&amp;amp;characterEncoding=utf-8&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;foreverlove&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;jdbcTemplate&quot; class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--åœ¨ XML é…ç½®æ–‡ä»¶ä¸­å¯åŠ¨ Spring çš„è‡ªåŠ¨æ‰«æåŠŸèƒ½ æˆ‘ä»¬å°±ä¸å†éœ€è¦åœ¨ XML ä¸­æ˜¾å¼ä½¿ç”¨ &lt;bean/&gt; è¿›è¡ŒBean çš„é…ç½®ã€‚ Spring åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶å°†è‡ªåŠ¨æ‰«æ com.imooc.sc æŒ‡å®šçš„åŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰ classæ–‡ä»¶ï¼Œ æ‰€æœ‰æ ‡æ³¨äº† @Repository çš„ç±»éƒ½å°†è¢«æ³¨å†Œä¸º Spring Beanã€‚ --&gt; &lt;context:component-scan base-package=&quot;com.imooc.sc&quot;/&gt; &lt;/beans&gt; åŸºæœ¬æ“ä½œæ‰‹æ³• public class Test { private JdbcTemplate jdbcTemplate; { ApplicationContext context = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;); jdbcTemplate = (JdbcTemplate)context.getBean(&quot;jdbcTemplate&quot;); } //create @org.junit.Test public void testExecute(){ jdbcTemplate.execute(&quot;create table user1(id int,name varchar(20))&quot;); } //insert @org.junit.Test public void testUpdate(){ String sql = &quot;insert into student(name,sex) values(?,?)&quot;; jdbcTemplate.update(sql,new Object[]{&quot;å¼ é£&quot;,&quot;ç”·&quot;}); } //update @org.junit.Test public void testUpdate2(){ String sql = &quot;update student set sex=? where id=?&quot;; jdbcTemplate.update(sql,&quot;å¥³&quot;,1); } //æ‰¹é‡æ›´æ–° @org.junit.Test public void testBatchUpdate(){ String[] sqls={ &quot;insert into student(name,sex) values(&#39;å…³ç¾½&#39;,&#39;å¥³&#39;)&quot;, &quot;insert into student(name,sex) values(&#39;åˆ˜å¤‡&#39;,&#39;ç”·&#39;)&quot;, &quot;update student set sex=&#39;å¥³&#39; where id=1&quot; }; jdbcTemplate.batchUpdate(sqls); } //æ‰¹é‡æ›´æ–° public void testBatchUpdate2(){ String sql = &quot;insert into selection(student,course) values(?,?)&quot;; List&lt;Object[]&gt; list = new ArrayList&lt;Object[]&gt;(); list.add(new Object[]{1005,1001}); list.add(new Object[]{1005,1003}); jdbcTemplate.batchUpdate(sql,list); } //æŸ¥è¯¢ @org.junit.Test public void testQuerySimple1(){ String sql = &quot;select count(*) from student&quot;; int count = jdbcTemplate.queryForObject(sql,Integer.class); System.out.println(count); } @org.junit.Test public void testQuerySimple2(){ String sql = &quot;select name from student where sex=?&quot;; List&lt;String&gt; names = jdbcTemplate.queryForList(sql,String.class,&quot;å¥³&quot;); System.out.println(names); } //æŸ¥è¯¢ç»“æœä¸ºmap @org.junit.Test public void testQueryMap1(){ String sql = &quot;select * from student where id = ?&quot;; Map&lt;String,Object&gt; stu = jdbcTemplate.queryForMap(sql,1); System.out.println(stu);//{id=1, name=å¼ é£, sex=å¥³, born=null} } @org.junit.Test public void testQueryMap2(){ String sql = &quot;select * from student&quot;; List&lt;Map&lt;String,Object&gt;&gt; stus = jdbcTemplate.queryForList(sql); System.out.println(stus); //[{id=1, name=å¼ é£, sex=å¥³, born=null}, {id=2, name=å…³ç¾½, sex=å¥³, born=null}] } //æŸ¥è¯¢ç»“æœè¿”å›å¯¹è±¡ public void testQueryEntity1(){ String sql = &quot;select * from student where id = ?&quot;; Student stu = jdbcTemplate.queryForObject(sql, new StudentRowMapper(), 1004); System.out.println(stu); } @org.junit.Test public void testQueryEntity2(){ String sql = &quot;select * from student&quot;; List&lt;Student&gt; stus = jdbcTemplate.query(sql,new StudentRowMapper()); System.out.println(stus); } private class StudentRowMapper implements RowMapper&lt;Student&gt;{ public Student mapRow(ResultSet resultSet, int i) throws SQLException { Student stu = new Student(); stu.setId(resultSet.getInt(&quot;id&quot;)); stu.setName(resultSet.getString(&quot;name&quot;)); stu.setSex(resultSet.getString(&quot;sex&quot;)); stu.setBorn(resultSet.getDate(&quot;born&quot;)); return stu; } } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"spring","slug":"spring","permalink":"/tags/spring/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"æ¡¥æ¥æ¨¡å¼","slug":"æŠ€æœ¯/æ¡¥æ¥æ¨¡å¼","date":"2020-10-13T16:30:00.000Z","updated":"2020-10-13T16:27:24.935Z","comments":true,"path":"2020/10/14/æŠ€æœ¯/æ¡¥æ¥æ¨¡å¼/","link":"","permalink":"/2020/10/14/æŠ€æœ¯/æ¡¥æ¥æ¨¡å¼/","excerpt":"","text":"åŸºæœ¬ä»‹ç» æ¡¥æ¥æ¨¡å¼(Bridgeæ¨¡å¼)æ˜¯æŒ‡:å°†å®ç°ä¸æŠ½è±¡æ”¾åœ¨ä¸¤ä¸ªä¸åŒçš„ç±»å±‚æ¬¡ä¸­ï¼Œä½¿ä¸¤ä¸ªå±‚æ¬¡å¯ä»¥ç‹¬ç«‹æ”¹å˜ã€‚ æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ Bridge æ¨¡å¼åŸºäºç±»çš„æœ€å°è®¾è®¡åŸåˆ™ï¼Œé€šè¿‡ä½¿ç”¨å°è£…ã€èšåˆåŠç»§æ‰¿ç­‰è¡Œä¸ºè®©ä¸åŒçš„ç±»æ‰¿æ‹…ä¸åŒçš„èŒè´£ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯æŠŠæŠ½è±¡(Abstraction)ä¸è¡Œä¸ºå®ç°(Implementation)åˆ†ç¦»å¼€æ¥ï¼Œä»è€Œå¯ä»¥ä¿æŒå„éƒ¨åˆ†çš„ç‹¬ç«‹æ€§ä»¥åŠåº”å¯¹ä»–ä»¬çš„ åŠŸèƒ½æ‰©å±• UML CODE public interface Brand { void open(); void close(); } public class Vivo implements Brand { @Override public void open() { System.out.println(&quot;VIVOæ‰‹æœºå¼€æœº&quot;); } @Override public void close() { System.out.println(&quot;VIVOæ‰‹æœºå…³æœº&quot;); } } public class Xiaomi implements Brand { @Override public void open() { System.out.println(&quot;Xiaomiæ‰‹æœºå¼€æœº&quot;); } @Override public void close() { System.out.println(&quot;Xiaomiæ‰‹æœºå…³æœº&quot;); } } public abstract class Phone { private Brand brand; public Phone(Brand brand) { this.brand = brand; } protected void open() { brand.open(); } protected void close() { brand.close(); } } public class FoldedPhone extends Phone { public FoldedPhone(Brand brand) { super(brand); } public void open() { super.open(); System.out.println(&quot;æŠ˜å æ ·å¼æ‰‹æœº&quot;); } public void close() { super.close(); System.out.println(&quot;æŠ˜å æ ·å¼æ‰‹æœº&quot;); } } public class UpRightPhone extends Phone { //æ„é€ å™¨ public UpRightPhone(Brand brand) { super(brand); } public void open() { super.open(); System.out.println(&quot; ç›´ç«‹æ ·å¼æ‰‹æœº &quot;); } public void close() { super.close(); System.out.println(&quot; ç›´ç«‹æ ·å¼æ‰‹æœº &quot;); } } public class Client { public static void main(String[] args) { //è·å–æŠ˜å å¼æ‰‹æœº (æ ·å¼ + å“ç‰Œ ) Phone phone1 = new FoldedPhone(new Xiaomi()); phone1.open(); phone1.close(); System.out.println(&quot;=======================&quot;); Phone phone2 = new FoldedPhone(new Vivo()); phone2.open(); phone2.close(); System.out.println(&quot;==============&quot;); UpRightPhone phone3 = new UpRightPhone(new Xiaomi()); phone3.open(); phone3.close(); System.out.println(&quot;==============&quot;); UpRightPhone phone4 = new UpRightPhone(new Vivo()); phone4.open(); phone4.close(); } } ä¼˜ç¼ºç‚¹ å®ç°äº†æŠ½è±¡å’Œå®ç°éƒ¨åˆ†çš„åˆ†ç¦»ï¼Œä»è€Œæå¤§çš„æä¾›äº†ç³»ç»Ÿçš„çµæ´»æ€§ï¼Œè®©æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†ç‹¬ç«‹å¼€æ¥ï¼Œè¿™æœ‰åŠ©äº ç³»ç»Ÿè¿›è¡Œåˆ†å±‚è®¾è®¡ï¼Œä»è€Œäº§ç”Ÿæ›´å¥½çš„ç»“æ„åŒ–ç³»ç»Ÿã€‚ å¯¹äºç³»ç»Ÿçš„é«˜å±‚éƒ¨åˆ†ï¼Œåªéœ€è¦çŸ¥é“æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†çš„æ¥å£å°±å¯ä»¥äº†ï¼Œå…¶å®ƒçš„éƒ¨åˆ†ç”±å…·ä½“ä¸šåŠ¡æ¥å®Œæˆã€‚ æ¡¥æ¥æ¨¡å¼æ›¿ä»£å¤šå±‚ç»§æ‰¿æ–¹æ¡ˆï¼Œå¯ä»¥å‡å°‘å­ç±»çš„ä¸ªæ•°ï¼Œé™ä½ç³»ç»Ÿçš„ç®¡ç†å’Œç»´æŠ¤æˆæœ¬ã€‚ æ¡¥æ¥æ¨¡å¼çš„å¼•å…¥å¢åŠ äº†ç³»ç»Ÿçš„ç†è§£å’Œè®¾è®¡éš¾åº¦ï¼Œç”±äºèšåˆå…³è”å…³ç³»å»ºç«‹åœ¨æŠ½è±¡å±‚ï¼Œè¦æ±‚å¼€å‘è€…é’ˆå¯¹æŠ½è±¡è¿›è¡Œè®¾è®¡å’Œç¼–ç¨‹ æ¡¥æ¥æ¨¡å¼è¦æ±‚æ­£ç¡®è¯†åˆ«å‡ºç³»ç»Ÿä¸­ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦(æŠ½è±¡ã€å’Œå®ç°)ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå³éœ€è¦æœ‰è¿™æ ·çš„åº”ç”¨åœºæ™¯ã€‚ æ¡¥æ¥æ¨¡å¼å…¶å®ƒåº”ç”¨åœºæ™¯å¯¹äºé‚£äº›ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ çš„ç³»ç»Ÿï¼Œæ¡¥æ¥æ¨¡å¼å°¤ä¸ºé€‚ç”¨.","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"é€‚é…å™¨æ¨¡å¼","slug":"æŠ€æœ¯/é€‚é…å™¨æ¨¡å¼","date":"2020-10-08T15:30:00.000Z","updated":"2020-10-08T15:31:39.776Z","comments":true,"path":"2020/10/08/æŠ€æœ¯/é€‚é…å™¨æ¨¡å¼/","link":"","permalink":"/2020/10/08/æŠ€æœ¯/é€‚é…å™¨æ¨¡å¼/","excerpt":"","text":"åŸºæœ¬ä»‹ç» é€‚é…å™¨æ¨¡å¼(AdapterPattern)å°†æŸä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·ç«¯æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£è¡¨ç¤ºï¼Œä¸»çš„ç›®çš„æ˜¯å…¼å®¹æ€§ï¼Œè®©åŸæœ¬ å› æ¥å£ä¸åŒ¹é…ä¸èƒ½ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»å¯ä»¥ååŒå·¥ä½œã€‚å…¶åˆ«åä¸ºåŒ…è£…å™¨(Wrapper)å°šç¡…è°· Java è®¾è®¡æ¨¡å¼ç¬¬ 9 ç«  é€‚é…å™¨è®¾è®¡æ¨¡å¼ 9.1 ç°å®ç”Ÿæ´»ä¸­çš„é€‚é…å™¨ä¾‹å­ é€‚é…å™¨æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ ä¸»è¦åˆ†ä¸ºä¸‰ç±»:ç±»é€‚é…å™¨æ¨¡å¼ã€å¯¹è±¡é€‚é…å™¨æ¨¡å¼ã€æ¥å£é€‚é…å™¨æ¨¡å¼ 1.ç±»é€‚é…å™¨æ¨¡å¼ åº”ç”¨å®ä¾‹è¯´æ˜ ä»¥ç”Ÿæ´»ä¸­å……ç”µå™¨çš„ä¾‹å­æ¥è®²è§£é€‚é…å™¨ï¼Œå……ç”µå™¨æœ¬èº«ç›¸å½“äº Adapterï¼Œ220V äº¤æµç”µç›¸å½“äº src (å³è¢«é€‚é…è€…)ï¼Œæˆ‘ä»¬ çš„ç›® dst(å³ ç›®æ ‡)æ˜¯ 5V ç›´æµç”µ UML CODE public class Voltage220V { public int output220V() { int src = 220; System.out.println(&quot;ç”µå‹=&quot; + src + &quot;V&quot;); return src; } } public interface IVoltage5V { public int output5V(); } public class VoltageAdapter extends Voltage220V implements IVoltage5V{ @Override public int output5V() { int srcV = output220V(); int dstV = srcV / 44; return dstV; } } public class Client { public static void main(String[] args) { System.out.println(&quot;ç±»é€‚é…å™¨æ¨¡å¼&quot;); VoltageAdapter voltageAdapter = new VoltageAdapter(); System.out.println(&quot;è½¬æ¢åç”µå‹&quot; + voltageAdapter.output5V()); } } ä¼˜ç¼ºç‚¹ Java æ˜¯å•ç»§æ‰¿æœºåˆ¶ï¼Œæ‰€ä»¥ç±»é€‚é…å™¨éœ€è¦ç»§æ‰¿ src ç±»è¿™ä¸€ç‚¹ç®—æ˜¯ä¸€ä¸ªç¼ºç‚¹, å› ä¸ºè¿™è¦æ±‚ dst å¿…é¡»æ˜¯æ¥å£ï¼Œæœ‰ä¸€å®šå±€ é™æ€§; src ç±»çš„æ–¹æ³•åœ¨ Adapter ä¸­éƒ½ä¼šæš´éœ²å‡ºæ¥ï¼Œä¹Ÿå¢åŠ äº†ä½¿ç”¨çš„æˆæœ¬ã€‚ ç”±äºå…¶ç»§æ‰¿äº†srcç±»ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ ¹æ®éœ€æ±‚é‡å†™srcç±»çš„æ–¹æ³•ï¼Œä½¿å¾—Adapterçš„çµæ´»æ€§å¢å¼ºäº†ã€‚ 2.å¯¹è±¡é€‚é…å™¨æ¨¡å¼ä»‹ç» æ ¹æ®â€œåˆæˆå¤ç”¨åŸåˆ™â€ï¼Œåœ¨ç³»ç»Ÿä¸­å°½é‡ä½¿ç”¨å…³è”å…³ç³»(èšåˆ)æ¥æ›¿ä»£ç»§æ‰¿å…³ç³»ã€‚ UML CODE public interface IVoltage5V { public int output5V(); } public class Voltage220V { public int output220V() { int src = 220; System.out.println(&quot;ç”µå‹=&quot; + src + &quot;V&quot;); return src; } } public class VoltageAdapter implements IVoltage5V { private Voltage220V voltage220V; public VoltageAdapter(Voltage220V voltage220V) { this.voltage220V = voltage220V; } @Override public int output5V() { int srcV = voltage220V.output220V(); int dstV = srcV / 44; return dstV; } } public class Client { public static void main(String[] args) { System.out.println(&quot;ç±»é€‚é…å™¨æ¨¡å¼&quot;); VoltageAdapter voltageAdapter = new VoltageAdapter(new Voltage220V()); System.out.println(&quot;è½¬æ¢åç”µå‹&quot; + voltageAdapter.output5V() + &quot;V&quot;); } } ä¼˜ç¼ºç‚¹ å¯¹è±¡é€‚é…å™¨å’Œç±»é€‚é…å™¨å…¶å®ç®—æ˜¯åŒä¸€ç§æ€æƒ³ï¼Œåªä¸è¿‡å®ç°æ–¹å¼ä¸åŒã€‚ æ ¹æ®åˆæˆå¤ç”¨åŸåˆ™ï¼Œä½¿ç”¨ç»„åˆæ›¿ä»£ç»§æ‰¿ï¼Œ æ‰€ä»¥å®ƒè§£å†³äº†ç±»é€‚é…å™¨å¿…é¡»ç»§æ‰¿ src çš„å±€é™æ€§é—®é¢˜ï¼Œä¹Ÿä¸å†è¦æ±‚ dst å¿…é¡»æ˜¯æ¥å£ã€‚ 3.æ¥å£é€‚é…å™¨æ¨¡å¼ä»‹ç» ä¸€äº›ä¹¦ç±ç§°ä¸º:é€‚é…å™¨æ¨¡å¼(DefaultAdapterPattern)æˆ–ç¼ºçœé€‚é…å™¨æ¨¡å¼ã€‚ æ ¸å¿ƒæ€è·¯:å½“ä¸éœ€è¦å…¨éƒ¨å®ç°æ¥å£æä¾›çš„æ–¹æ³•æ—¶ï¼Œå¯å…ˆè®¾è®¡ä¸€ä¸ªæŠ½è±¡ç±»å®ç°æ¥å£ï¼Œå¹¶ä¸ºè¯¥æ¥å£ä¸­æ¯ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤å®ç°(ç©ºæ–¹æ³•)ï¼Œé‚£ä¹ˆè¯¥æŠ½è±¡ç±»çš„å­ç±»å¯æœ‰é€‰æ‹©åœ°è¦†ç›–çˆ¶ç±»çš„æŸäº›æ–¹æ³•æ¥å®ç°éœ€æ±‚ é€‚ç”¨äºä¸€ä¸ªæ¥å£ä¸æƒ³ä½¿ç”¨å…¶æ‰€æœ‰çš„æ–¹æ³•çš„æƒ…å†µã€‚ UML CODE public interface Interface4 { public void m1(); public void m2(); public void m3(); public void m4(); } public abstract class AbsAdapter implements Interface4{ //é»˜è®¤å®ç° @Override public void m1() { } @Override public void m2() { } @Override public void m3() { } @Override public void m4() { } } public class Client { public static void main(String[] args) { AbsAdapter absAdapter = new AbsAdapter() { //åªéœ€è¦å»è¦†ç›–æˆ‘ä»¬ éœ€è¦ä½¿ç”¨ æ¥å£æ–¹æ³• @Override public void m1() { System.out.println(&quot;m1 method&quot;); } }; absAdapter.m1(); } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"å»ºé€ è€…æ¨¡å¼","slug":"æŠ€æœ¯/å»ºé€ è€…æ¨¡å¼","date":"2020-10-08T03:30:00.000Z","updated":"2020-10-08T03:58:00.727Z","comments":true,"path":"2020/10/08/æŠ€æœ¯/å»ºé€ è€…æ¨¡å¼/","link":"","permalink":"/2020/10/08/æŠ€æœ¯/å»ºé€ è€…æ¨¡å¼/","excerpt":"","text":"åŸºæœ¬ä»‹ç» å»ºé€ è€…æ¨¡å¼(BuilderPattern)åˆå«ç”Ÿæˆå™¨æ¨¡å¼ï¼Œæ˜¯ä¸€ç§å¯¹è±¡æ„å»ºæ¨¡å¼ã€‚å®ƒå¯ä»¥å°†å¤æ‚å¯¹è±¡çš„å»ºé€ è¿‡ç¨‹æŠ½è±¡å‡º æ¥(æŠ½è±¡ç±»åˆ«)ï¼Œä½¿è¿™ä¸ªæŠ½è±¡è¿‡ç¨‹çš„ä¸åŒå®ç°æ–¹æ³•å¯ä»¥æ„é€ å‡ºä¸åŒè¡¨ç°(å±æ€§)çš„å¯¹è±¡ã€‚ å»ºé€ è€…æ¨¡å¼çš„å››ä¸ªè§’è‰² Product(äº§å“è§’è‰²): ä¸€ä¸ªå…·ä½“çš„äº§å“å¯¹è±¡ã€‚ Builder(æŠ½è±¡å»ºé€ è€…): åˆ›å»ºä¸€ä¸ª Product å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šçš„ æ¥å£/æŠ½è±¡ç±»ã€‚ ConcreteBuilder(å…·ä½“å»ºé€ è€…): å®ç°æ¥å£ï¼Œæ„å»ºå’Œè£…é…å„ä¸ªéƒ¨ä»¶ã€‚ Director(æŒ‡æŒ¥è€…): æ„å»ºä¸€ä¸ªä½¿ç”¨ Builder æ¥å£çš„å¯¹è±¡ã€‚å®ƒä¸»è¦æ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚å®ƒä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€æ˜¯:éš”ç¦»äº†å®¢æˆ·ä¸å¯¹è±¡çš„ç”Ÿäº§è¿‡ç¨‹ï¼ŒäºŒæ˜¯:è´Ÿè´£æ§åˆ¶äº§å“å¯¹è±¡çš„ç”Ÿäº§è¿‡ç¨‹ã€‚ å»ºé€ è€…æ¨¡å¼è§£å†³ç›–æˆ¿éœ€æ±‚ éœ€è¦å»ºæˆ¿å­:è¿™ä¸€è¿‡ç¨‹ä¸ºæ‰“æ¡©ã€ç Œå¢™ã€å°é¡¶ã€‚ä¸ç®¡æ˜¯æ™®é€šæˆ¿å­ä¹Ÿå¥½ï¼Œåˆ«å¢…ä¹Ÿå¥½éƒ½éœ€è¦ç»å†è¿™äº›è¿‡ç¨‹ï¼Œä¸‹é¢æˆ‘ä»¬ ä½¿ç”¨å»ºé€ è€…æ¨¡å¼(Builder Pattern)æ¥å®Œæˆ UML CODE public abstract class HouseBuilder { protected House house = new House(); //å»ºé€ çš„æµç¨‹æµç¨‹å†™å¥½ public abstract void buildBasic(); public abstract void buildWalls(); public abstract void roofed(); //å»ºé€ å¥½æˆ¿å­ï¼Œå°†äº§å“è¿”å› public House buildHouse() { return house; } } public class CommonHouseBuilder extends HouseBuilder { @Override public void buildBasic() { System.out.println(&quot;æ™®é€šæˆ¿å­æ‰“åœ°åŸº5ç±³&quot;); } @Override public void buildWalls() { System.out.println(&quot;æ™®é€šæˆ¿å­ç Œå¢™10å˜ç±³&quot;); } @Override public void roofed() { System.out.println(&quot;æ™®é€šæˆ¿å­å±‹é¡¶&quot;); } } public class HighHouseBuilder extends HouseBuilder { @Override public void buildBasic() { System.out.println(&quot; é«˜æ¥¼çš„æ‰“åœ°åŸº100ç±³ &quot;); } @Override public void buildWalls() { System.out.println(&quot; é«˜æ¥¼çš„ç Œå¢™20å˜ç±³ &quot;); } @Override public void roofed() { System.out.println(&quot; é«˜æ¥¼çš„é€æ˜å±‹é¡¶ &quot;); } } public class HouseDirector { HouseBuilder houseBuilder; public HouseDirector(HouseBuilder houseBuilder) { this.houseBuilder = houseBuilder; } //å¦‚ä½•å¤„ç†å»ºé€ æˆ¿å­çš„æµç¨‹ï¼Œäº¤ç»™æŒ‡æŒ¥è€… public House constructHouse() { houseBuilder.buildBasic(); houseBuilder.buildWalls(); houseBuilder.roofed(); return houseBuilder.buildHouse(); } } public class House { public String base; public String wall; public String rooted; } public class Client { public static void main(String[] args) { HouseDirector houseDirector = new HouseDirector(new CommonHouseBuilder()); //å®Œæˆç›–æˆ¿å­ï¼Œè¿”å›äº§å“(æ™®é€šæˆ¿å­) House house = houseDirector.constructHouse(); } } ä¼˜ç‚¹ äº§å“å’Œäº§å“å»ºé€ è¿‡ç¨‹è§£è€¦ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"åŸå‹æ¨¡å¼","slug":"æŠ€æœ¯/åŸå‹æ¨¡å¼","date":"2020-10-07T14:28:00.000Z","updated":"2020-10-07T15:14:41.085Z","comments":true,"path":"2020/10/07/æŠ€æœ¯/åŸå‹æ¨¡å¼/","link":"","permalink":"/2020/10/07/æŠ€æœ¯/åŸå‹æ¨¡å¼/","excerpt":"","text":"åŸºæœ¬ä»‹ç» åŸå‹æ¨¡å¼(Prototypeæ¨¡å¼)æ˜¯æŒ‡:ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹ï¼Œåˆ›å»ºæ–°çš„å¯¹è±¡ 1.åŸºæœ¬ç±»å‹çš„æ‹·è´CODE public class Sheep implements Cloneable{ public String name; public int age; public Sheep friend;//æ˜¯å¯¹è±¡, å…‹éš†æ˜¯ä¼šå¦‚ä½•å¤„ç†, é»˜è®¤æ˜¯æµ…æ‹·è´ public Sheep(String name, int age) { this.name = name; this.age = age; } @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } } public class Client { public static void main(String[] args) throws CloneNotSupportedException { Sheep sheep1 = new Sheep(&quot;zhangsan&quot;,1); Sheep sheep2 = new Sheep(&quot;lisi&quot;, 2); sheep1.friend = sheep2; sheep2.friend = sheep1; Sheep sheep3 = (Sheep)sheep1.clone(); System.out.println(sheep3 == sheep1);//false System.out.println(sheep3.friend == sheep1.friend);//true } } æ³¨æ„ æˆå‘˜å˜é‡ä¸ºå¯¹è±¡æ—¶ï¼Œå…‹éš†æ˜¯æµ…æ‹·è´ï¼Œä½¿ç”¨é»˜è®¤æ‹·è´æ˜¯æ‹·è´çš„åœ°å€ 2.æ·±æ‹·è´åŸºæœ¬ä»‹ç» å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰åŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡å€¼ ä¸ºæ‰€æœ‰å¼•ç”¨æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡ç”³è¯·å­˜å‚¨ç©ºé—´ï¼Œå¹¶å¤åˆ¶æ¯ä¸ªå¼•ç”¨æ•°æ®ç±»å‹æˆå‘˜å˜é‡æ‰€å¼•ç”¨çš„å¯¹è±¡ï¼Œç›´åˆ°è¯¥å¯¹è±¡å¯è¾¾çš„æ‰€æœ‰å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹è±¡è¿›è¡Œæ·±æ‹·è´è¦å¯¹æ•´ä¸ªå¯¹è±¡(åŒ…æ‹¬å¯¹è±¡çš„å¼•ç”¨ç±»å‹)è¿›è¡Œæ‹·è´ æ·±æ‹·è´å®ç°æ–¹å¼1:é‡å†™cloneæ–¹æ³•æ¥å®ç°æ·±æ‹·è´ æ·±æ‹·è´å®ç°æ–¹å¼2:é€šè¿‡å¯¹è±¡åºåˆ—åŒ–å®ç°æ·±æ‹·è´(æ¨è) CODE package blog.prototype; import java.io.Serializable; public class DeepCloneableTarget implements Serializable, Cloneable { public String cloneName; public String cloneClass; public DeepCloneableTarget(String cloneName, String cloneClass) { this.cloneName = cloneName; this.cloneClass = cloneClass; } //å› ä¸ºè¯¥ç±»çš„å±æ€§ï¼Œéƒ½æ˜¯ String , å› æ­¤æˆ‘ä»¬è¿™é‡Œä½¿ç”¨é»˜è®¤çš„ clone å®Œæˆå³å¯ @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } } package blog.prototype; import java.io.*; public class DeepProtoType implements Serializable, Cloneable { public String name; public DeepCloneableTarget deepCloneableTarget; //æ·±æ‹·è´ - æ–¹å¼ 1 ä½¿ç”¨clone æ–¹æ³• @Override protected Object clone() throws CloneNotSupportedException { Object deep = null; //è¿™é‡Œå®Œæˆå¯¹åŸºæœ¬æ•°æ®ç±»å‹(å±æ€§)å’Œ String çš„å…‹éš† deep = super.clone(); //å¯¹å¼•ç”¨ç±»å‹çš„å±æ€§ï¼Œè¿›è¡Œå•ç‹¬å¤„ç† DeepProtoType deepProtoType = (DeepProtoType)deep; deepProtoType.deepCloneableTarget = (DeepCloneableTarget)deepCloneableTarget.clone(); return deepProtoType; } //æ·±æ‹·è´ - æ–¹å¼ 2 é€šè¿‡å¯¹è±¡çš„åºåˆ—åŒ–å®ç° (æ¨è) public Object deepClone() { //åˆ›å»ºæµå¯¹è±¡ ByteArrayOutputStream bos = null; ObjectOutputStream oos = null; ByteArrayInputStream bis = null; ObjectInputStream ois = null; DeepProtoType copyObj = null; try { //åºåˆ—åŒ– bos = new ByteArrayOutputStream(); oos = new ObjectOutputStream(bos); oos.writeObject(this); //å½“å‰è¿™ä¸ªå¯¹è±¡ä»¥å¯¹è±¡æµçš„æ–¹å¼è¾“å‡º //ååºåˆ—åŒ– bis = new ByteArrayInputStream(bos.toByteArray()); ois = new ObjectInputStream(bis); copyObj = (DeepProtoType)ois.readObject(); } catch (Exception e) { e.printStackTrace(); } finally { try { bos.close(); oos.close(); bis.close(); ois.close(); } catch (IOException e) { e.printStackTrace(); } } return copyObj; } } package blog.prototype; public class Client { public static void main(String[] args) throws CloneNotSupportedException { DeepCloneableTarget deepCloneableTarget = new DeepCloneableTarget(&quot;cloneName&quot;,&quot;cloneClass&quot;); DeepProtoType deepProtoType = new DeepProtoType(); deepProtoType.name = &quot;DeepProtoType&quot;; deepProtoType.deepCloneableTarget = deepCloneableTarget; DeepProtoType deepProtoType1 = (DeepProtoType) deepProtoType.clone(); System.out.println(deepProtoType1.name); System.out.println(deepProtoType1.deepCloneableTarget.cloneName); System.out.println(deepProtoType.deepCloneableTarget == deepProtoType1.deepCloneableTarget);//false DeepProtoType deepProtoType2 = (DeepProtoType) deepProtoType.deepClone(); System.out.println(deepProtoType2.name); System.out.println(deepProtoType2.deepCloneableTarget.cloneName); System.out.println(deepProtoType.deepCloneableTarget == deepProtoType2.deepCloneableTarget);//false } } ä¼˜ç¼ºç‚¹ åˆ›å»ºæ–°çš„å¯¹è±¡æ¯”è¾ƒå¤æ‚æ—¶ï¼Œå¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼ç®€åŒ–å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæé«˜æ•ˆç‡ ä¸ç”¨é‡æ–°åˆå§‹åŒ–å¯¹è±¡ï¼Œè€Œæ˜¯åŠ¨æ€åœ°è·å¾—å¯¹è±¡è¿è¡Œæ—¶çš„çŠ¶æ€ å¦‚æœåŸå§‹å¯¹è±¡å‘ç”Ÿå˜åŒ–(å¢åŠ æˆ–è€…å‡å°‘å±æ€§)ï¼Œå…¶å®ƒå…‹éš†å¯¹è±¡çš„ä¹Ÿä¼šå‘ç”Ÿç›¸åº”çš„å˜åŒ–ï¼Œæ— éœ€ä¿®æ”¹ä»£ç  åœ¨å®ç°æ·±å…‹éš†çš„æ—¶å€™å¯èƒ½éœ€è¦æ¯”è¾ƒå¤æ‚çš„ä»£ç  ç¼ºç‚¹:éœ€è¦ä¸ºæ¯ä¸€ä¸ªç±»é…å¤‡ä¸€ä¸ªå…‹éš†æ–¹æ³•ï¼Œè¿™å¯¹å…¨æ–°çš„ç±»æ¥è¯´ä¸æ˜¯å¾ˆéš¾ï¼Œä½†å¯¹å·²æœ‰çš„ç±»è¿›è¡Œæ”¹é€ æ—¶ï¼Œéœ€è¦ä¿®æ”¹å…¶æºä»£ç ï¼Œè¿èƒŒäº† ocp åŸåˆ™ï¼Œè¿™ç‚¹è¯·æ³¨æ„.","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"å·¥å‚æ¨¡å¼","slug":"æŠ€æœ¯/å·¥å‚æ¨¡å¼","date":"2020-10-07T06:00:00.000Z","updated":"2020-10-07T15:10:02.769Z","comments":true,"path":"2020/10/07/æŠ€æœ¯/å·¥å‚æ¨¡å¼/","link":"","permalink":"/2020/10/07/æŠ€æœ¯/å·¥å‚æ¨¡å¼/","excerpt":"","text":"1.ç®€å•å·¥å‚æ¨¡å¼çœ‹ä¸€ä¸ªæŠ«è¨çš„é¡¹ç›®:è¦ä¾¿äºæŠ«è¨ç§ç±»çš„æ‰©å±•ï¼Œè¦ä¾¿äºç»´æŠ¤ æŠ«è¨çš„ç§ç±»å¾ˆå¤š(æ¯”å¦‚ GreekPizzã€CheesePizz ç­‰) æŠ«è¨çš„åˆ¶ä½œæœ‰ prepareï¼Œbake, cut, box å®ŒæˆæŠ«è¨åº—è®¢è´­åŠŸèƒ½ã€‚ æ€è·¯ æŠŠåˆ›å»º Pizza å¯¹è±¡å°è£…åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬æœ‰æ–°çš„ Pizza ç§ç±»æ—¶ï¼Œåªéœ€è¦ä¿®æ”¹è¯¥ç±»å°±å¯ï¼Œå…¶å®ƒæœ‰åˆ›å»ºåˆ° Pizza å¯¹è±¡çš„ä»£ç å°±ä¸éœ€è¦ä¿®æ”¹äº† UML package blog.factory; import blog.factory.pizza.CheesePizza; import blog.factory.pizza.GreekPizza; import blog.factory.pizza.Pizza; public class SimpleFactory { //ç®€å•å·¥å‚æ¨¡å¼ public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;å¥¶é…ª&quot;)) { pizza = new CheesePizza(); pizza.setName(&quot;å¥¶é…ªæŠ«è¨&quot;); } else if (orderType.equals(&quot;å¸Œè…Š&quot;)) { pizza = new GreekPizza(); pizza.setName(&quot;å¸Œè…ŠæŠ«è¨&quot;); } return pizza; } //ç®€å•å·¥å‚æ¨¡å¼ï¼Œé™æ€å·¥å‚æ¨¡å¼ public static Pizza createPizza2(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;å¥¶é…ª&quot;)) { pizza = new CheesePizza(); pizza.setName(&quot;å¥¶é…ªæŠ«è¨&quot;); } else if (orderType.equals(&quot;å¸Œè…Š&quot;)) { pizza = new GreekPizza(); pizza.setName(&quot;å¸Œè…ŠæŠ«è¨&quot;); } return pizza; } } package blog.factory; import blog.factory.pizza.Pizza; public class OrderPizza { private SimpleFactory simpleFactory; public OrderPizza(SimpleFactory simpleFactory) { this.simpleFactory = simpleFactory; } public void makePizza(String orderType) { Pizza pizza = simpleFactory.createPizza(orderType); pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); } } package blog.factory; public class Test { public static void main(String[] args) { OrderPizza orderPizza = new OrderPizza(new SimpleFactory()); orderPizza.makePizza(&quot;å¸Œè…Š&quot;); } } package blog.factory.pizza; public abstract class Pizza { private String name; //ä¸åŒç±»å‹åˆ¶ä½œææ–™çš„å‡†å¤‡ä¸åŒ public abstract void prepare(); public void bake() { System.out.println(name + &quot;baking&quot;); } public void cut() { System.out.println(name + &quot;cutting&quot;); } public void box() { System.out.println(name + &quot;boxing&quot;); } public String getName() { return name; } public void setName(String name) { this.name = name; } } package blog.factory.pizza; public class GreekPizza extends Pizza { @Override public void prepare() { System.out.println(&quot;ç»™å¸Œè…ŠæŠ«è¨å‡†å¤‡åŸææ–™&quot;); } } package blog.factory.pizza; public class CheesePizza extends Pizza{ @Override public void prepare() { System.out.println(&quot;åˆ¶ä½œå¥¶é…ªæŠ«è¨ï¼Œå‡†å¤‡ææ–™&quot;); } } 2.å·¥å‚æ–¹æ³•æ¨¡å¼éœ€æ±‚ æŠ«è¨é¡¹ç›®æ–°çš„éœ€æ±‚:å®¢æˆ·åœ¨ç‚¹æŠ«è¨æ—¶ï¼Œå¯ä»¥ç‚¹ä¸åŒå£å‘³çš„æŠ«è¨ï¼Œæ¯”å¦‚ åŒ—äº¬çš„å¥¶é…ª pizzaã€åŒ—äº¬çš„å¸Œè…Š pizza æˆ– è€…æ˜¯ä¼¦æ•¦çš„å¥¶é…ª pizzaã€ä¼¦æ•¦çš„å¸Œè…Š pizzaã€‚ æ€è·¯ ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼ï¼Œåˆ›å»ºä¸åŒçš„ç®€å•å·¥å‚ç±»ï¼Œæ¯”å¦‚ BJPizzaSimpleFactoryã€LDPizzaSimpleFactory ç­‰ç­‰.ä»å½“å‰è¿™ä¸ªæ¡ˆä¾‹æ¥è¯´ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°é¡¹ç›®çš„è§„æ¨¡ï¼Œä»¥åŠè½¯ä»¶çš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å¹¶ä¸æ˜¯ç‰¹åˆ«å¥½ å·¥å‚æ–¹æ³•æ¨¡å¼è®¾è®¡æ–¹æ¡ˆ:å°†æŠ«è¨é¡¹ç›®çš„å®ä¾‹åŒ–åŠŸèƒ½æŠ½è±¡æˆæŠ½è±¡æ–¹æ³•ï¼Œåœ¨ä¸åŒçš„å£å‘³ç‚¹é¤å­ç±»ä¸­å…·ä½“å®ç°ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼:å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–çš„ç±»ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼å°†å¯¹è±¡çš„å®ä¾‹ åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚UML CODE public abstract class PizzaFactory { public abstract Pizza createPizza(String orderType); } public class BJPizzaFactory extends PizzaFactory{ @Override public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;cheese&quot;)) { pizza = new BJGreekPizza(); } else if (orderType.equals(&quot;greek&quot;)) { pizza = new BJGreekPizza(); } return pizza; } } public class LDPizzaFactory extends PizzaFactory{ @Override public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;cheese&quot;)) { pizza = new LDCheesePizza(); } else if (orderType.equals(&quot;greek&quot;)) { pizza = new LDGreekOPizza(); } return pizza; } } public class Order { private PizzaFactory pizzaFactory; public Order(PizzaFactory pizzaFactory) { this.pizzaFactory = pizzaFactory; } public void makePizza(String type) { Pizza pizza = pizzaFactory.createPizza(type); pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); } } public class Client { public static void main(String[] args) { Order order = new Order(new LDPizzaFactory()); order.makePizza(&quot;greek&quot;); } } 3.æŠ½è±¡å·¥å‚æ¨¡å¼æ€è·¯ å°†å·¥å‚æŠ½è±¡æˆä¸¤å±‚ï¼ŒAbsFactory(æŠ½è±¡å·¥å‚) å’Œ å…·ä½“å®ç°çš„å·¥å‚å­ç±»ï¼Œå®Œæˆäº†å¯¹åœ°ç‚¹BJå’ŒLDçš„åŒºåˆ† UML CODE public interface AbsFactory { public Pizza createPizza(String orderType); } public class BJFactory implements AbsFactory { @Override public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;cheese&quot;)) { pizza = new BJCheesePizza(); } else if (orderType.equals(&quot;greek&quot;)) { pizza = new BJGreekPizza(); } return pizza; } } public class LDFactory implements AbsFactory { @Override public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;cheese&quot;)) { pizza = new LDCheesePizza(); } else if (orderType.equals(&quot;greek&quot;)) { pizza = new LDGreekOPizza(); } return pizza; } } public class Order { private AbsFactory absFactory; public Order(AbsFactory absFactory) { this.absFactory = absFactory; } public void makePizza(String type) { Pizza pizza = absFactory.createPizza(type); pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); } } public class Client { public static void main(String[] args) { Order order = new Order(new LDFactory()); order.makePizza(&quot;cheese&quot;); } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"å•ä¾‹æ¨¡å¼","slug":"æŠ€æœ¯/å•ä¾‹æ¨¡å¼","date":"2020-10-06T14:28:00.000Z","updated":"2020-10-06T14:30:45.475Z","comments":true,"path":"2020/10/06/æŠ€æœ¯/å•ä¾‹æ¨¡å¼/","link":"","permalink":"/2020/10/06/æŠ€æœ¯/å•ä¾‹æ¨¡å¼/","excerpt":"","text":"1.é¥¿æ±‰å¼(é™æ€å¸¸é‡)package blog.singleton; public class SingletonTest { public static void main(String[] args) { Singleton singleton1 = Singleton.getInstance(); Singleton singleton2 = Singleton.getInstance(); System.out.println(singleton1 == singleton2); } } class Singleton { // 1.æ„é€ å™¨ç§æœ‰åŒ–ï¼Œé˜²æ­¢å¤–éƒ¨new private Singleton() {} // 2.åœ¨è£…è½½æ—¶ï¼Œå®Œæˆå®ä¾‹åŒ– private final static Singleton instance = new Singleton(); // 3.é€šè¿‡å…¬æœ‰é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡ public static Singleton getInstance() { return instance; } } ä¼˜ç‚¹ ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ã€‚é¿å…äº†çº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚ ç¼ºç‚¹ åœ¨ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ï¼Œæ²¡æœ‰è¾¾åˆ°LazyLoadingçš„æ•ˆæœã€‚å¦‚æœä»å§‹è‡³ç»ˆä»æœªä½¿ç”¨è¿‡è¿™ä¸ªå®ä¾‹ï¼Œåˆ™ä¼šé€ æˆå†…å­˜çš„æµªè´¹ è¿™ç§æ–¹å¼åŸºäºclassloderæœºåˆ¶é¿å…äº†å¤šçº¿ç¨‹çš„åŒæ­¥é—®é¢˜ï¼Œä¸è¿‡ï¼Œinstanceåœ¨ç±»è£…è½½æ—¶å°±å®ä¾‹åŒ–ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸­å¤§ å¤šæ•°éƒ½æ˜¯è°ƒç”¨ getInstance æ–¹æ³•ï¼Œä½†æ˜¯å¯¼è‡´ç±»è£…è½½çš„åŸå› æœ‰å¾ˆå¤šç§ï¼Œå› æ­¤ä¸èƒ½ç¡®å®šæœ‰å…¶ä»–çš„æ–¹å¼(æˆ–è€…å…¶ä»–çš„é™ æ€æ–¹æ³•)å¯¼è‡´ç±»è£…è½½ï¼Œè¿™æ—¶å€™åˆå§‹åŒ– instance å°±æ²¡æœ‰è¾¾åˆ° lazy loading çš„æ•ˆæœ ç»“è®º è¿™ç§å•ä¾‹æ¨¡å¼å¯ç”¨ï¼Œå¯èƒ½é€ æˆå†…å­˜æµªè´¹ 2.é¥¿æ±‰å¼(é™æ€ä»£ç å—)class Singleton { private Singleton() {} private static Singleton instance; { instance = new Singleton(); } public static Singleton getInstance() { return instance; } } ä¼˜ç‚¹ç¼ºç‚¹è¿™ç§æ–¹å¼å’Œä¸Šé¢çš„æ–¹å¼å…¶å®ç±»ä¼¼ï¼Œåªä¸è¿‡å°†ç±»å®ä¾‹åŒ–çš„è¿‡ç¨‹æ”¾åœ¨äº†é™æ€ä»£ç å—ä¸­ï¼Œä¹Ÿæ˜¯åœ¨ç±»è£…è½½çš„æ—¶å€™ï¼Œå°±æ‰§ è¡Œé™æ€ä»£ç å—ä¸­çš„ä»£ç ï¼Œåˆå§‹åŒ–ç±»çš„å®ä¾‹ã€‚ä¼˜ç¼ºç‚¹å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ã€‚ ç»“è®ºè¿™ç§å•ä¾‹æ¨¡å¼å¯ç”¨ï¼Œä½†æ˜¯å¯èƒ½é€ æˆå†…å­˜æµªè´¹ 3.æ‡’æ±‰å¼(çº¿ç¨‹ä¸å®‰å…¨)class Singleton { private static Singleton instance; private Singleton(){} public static Singleton getInstance() { if (instance == null) { instance = new Singleton(); } return instance; } } ä¼˜ç¼ºç‚¹ èµ·åˆ°äº†LazyLoadingçš„æ•ˆæœï¼Œä½†æ˜¯åªèƒ½åœ¨å•çº¿ç¨‹ä¸‹ä½¿ç”¨ã€‚ å¦‚æœåœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†if(singleton==null)åˆ¤æ–­è¯­å¥å—ï¼Œè¿˜æœªæ¥å¾—åŠå¾€ä¸‹æ‰§è¡Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿé€šè¿‡äº†è¿™ä¸ªåˆ¤æ–­è¯­å¥ï¼Œè¿™æ—¶ä¾¿ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ã€‚æ‰€ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¸å¯ä½¿ç”¨è¿™ç§æ–¹å¼ ç»“è®º å®é™…å¼€å‘ä¸­ï¼Œä¸è¦ä½¿ç”¨è¿™ç§æ–¹å¼. 4.æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•ï¼Œä¸æ¨èä½¿ç”¨)class Singleton { private static Singleton instance; private Singleton(){}; //æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼ŒåŠ å…¥åŒæ­¥å¤„ç†çš„ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ public static synchronized Singleton getInstance() { if (instance == null) { instance = new Singleton(); } return instance; } } ä¼˜ç¼ºç‚¹ è§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ æ•ˆç‡å¤ªä½äº†ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æƒ³è·å¾—ç±»çš„å®ä¾‹æ—¶å€™ï¼Œæ‰§è¡ŒgetInstance()æ–¹æ³•éƒ½è¦è¿›è¡ŒåŒæ­¥ã€‚è€Œå…¶å®è¿™ä¸ªæ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡å®ä¾‹åŒ–ä»£ç å°±å¤Ÿäº†ï¼Œåé¢çš„æƒ³è·å¾—è¯¥ç±»å®ä¾‹ï¼Œç›´æ¥ return å°±è¡Œäº†ã€‚æ–¹æ³•è¿›è¡ŒåŒæ­¥æ•ˆç‡å¤ªä½ ç»“è®º å®é™…å¼€å‘ä¸­ï¼Œä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ 5. æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—ï¼Œä¸æ¨è)class Singleton { private static Singleton instance; private Singleton(){}; public static Singleton getInstance() { if (instance == null) { synchronized (Singleton.class) { instance = new Singleton(); } } return instance; } } ä¼˜ç¼ºç‚¹ ä¸ä¸Šä¸€ä¸ªæ¨¡å¼åŒæ ·ï¼Œè§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†æ•ˆç‡å¤ªä½äº† 6.åŒé‡æ£€æŸ¥(æ¨èä½¿ç”¨)class Singleton { private static volatile Singleton instance;//volatile å¾ˆé‡è¦ private Singleton() {} //åŠ å…¥åŒé‡æ£€æŸ¥ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜, åŒæ—¶è§£å†³æ‡’åŠ è½½é—®é¢˜,åŒæ—¶ä¿è¯äº†æ•ˆç‡, æ¨èä½¿ç”¨ public static synchronized Singleton getInstance() { if (instance == null) { synchronized (Singleton.class) { if (instance == null) { instance = new Singleton(); } } } return instance; } } ä¼˜ç¼ºç‚¹ Double-Check æ¦‚å¿µæ˜¯å¤šçº¿ç¨‹å¼€å‘ä¸­å¸¸ä½¿ç”¨åˆ°çš„ï¼Œå¦‚ä»£ç ä¸­æ‰€ç¤ºï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸¤æ¬¡ if (singleton == null)æ£€æŸ¥ï¼Œè¿™ æ ·å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚ è¿™æ ·ï¼Œå®ä¾‹åŒ–ä»£ç åªç”¨æ‰§è¡Œä¸€æ¬¡ï¼Œåé¢å†æ¬¡è®¿é—®æ—¶ï¼Œåˆ¤æ–­if(singleton==null)ï¼Œç›´æ¥returnå®ä¾‹åŒ–å¯¹è±¡ï¼Œä¹Ÿé¿ å…çš„åå¤è¿›è¡Œæ–¹æ³•åŒæ­¥. çº¿ç¨‹å®‰å…¨;å»¶è¿ŸåŠ è½½;æ•ˆç‡è¾ƒé«˜ volatile ç¦æ­¢æŒ‡ä»¤é‡æ’ ç»“è®º åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ¨èä½¿ç”¨è¿™ç§å•ä¾‹è®¾è®¡æ¨¡å¼ 7.é™æ€å†…éƒ¨ç±»(æ¨è)class Singleton { private static volatile Singleton instance;//volatile å¾ˆé‡è¦ private Singleton() {} private static class SingletonInstance { private static final Singleton INSTANCE = new Singleton(); } public static synchronized Singleton getInstance() { return SingletonInstance.INSTANCE; } } ä¼˜ç¼ºç‚¹ è¿™ç§æ–¹å¼é‡‡ç”¨äº†ç±»è£…è½½çš„æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ–å®ä¾‹æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚ é™æ€å†…éƒ¨ç±»æ–¹å¼åœ¨Singletonç±»è¢«è£…è½½æ—¶å¹¶ä¸ä¼šç«‹å³å®ä¾‹åŒ–ï¼Œè€Œæ˜¯åœ¨éœ€è¦å®ä¾‹åŒ–æ—¶ï¼Œè°ƒç”¨getInstanceæ–¹æ³•ï¼Œæ‰ä¼šè£…è½½ SingletonInstance ç±»ï¼Œä»è€Œå®Œæˆ Singleton çš„å®ä¾‹åŒ–ã€‚ ç±»çš„é™æ€å±æ€§åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½ç±»çš„æ—¶å€™åˆå§‹åŒ–ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼ŒJVMå¸®åŠ©æˆ‘ä»¬ä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨æ€§ï¼Œåœ¨ç±»è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œåˆ«çš„çº¿ç¨‹æ˜¯æ— æ³•è¿›å…¥çš„ã€‚ é¿å…äº†çº¿ç¨‹ä¸å®‰å…¨ï¼Œåˆ©ç”¨é™æ€å†…éƒ¨ç±»ç‰¹ç‚¹å®ç°å»¶è¿ŸåŠ è½½ï¼Œæ•ˆç‡é«˜ ç»“è®º æ¨èä½¿ç”¨ 8.æšä¸¾ï¼ˆæ¨èä½¿ç”¨ï¼‰package blog.singleton; public class SingletonTest { public static void main(String[] args) { Singleton singleton1 = Singleton.INSTANCE; Singleton singleton2 = Singleton.INSTANCE; System.out.println(singleton1 == singleton2); singleton1.sayOk(); } } // enum Singleton { INSTANCE;//æšä¸¾å®ä¾‹ public void sayOk() { System.out.println(&quot;ok~&quot;); } } ä¼˜ç¼ºç‚¹ è¿™å€ŸåŠ©JDK1.5ä¸­æ·»åŠ çš„æšä¸¾æ¥å®ç°å•ä¾‹æ¨¡å¼ã€‚ä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œä¸”è¿˜èƒ½é˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»º æ–°çš„å¯¹è±¡ã€‚ è¿™ç§æ–¹å¼æ˜¯EffectiveJavaä½œè€…JoshBlochæå€¡çš„æ–¹å¼ ç»“è®º æ¨èä½¿ç”¨ 9.ä½¿ç”¨åœºæ™¯éœ€è¦é¢‘ç¹çš„è¿›è¡Œåˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ã€åˆ›å»ºå¯¹è±¡æ—¶è€—æ—¶è¿‡å¤šæˆ–è€—è´¹èµ„æºè¿‡å¤š(å³:é‡é‡çº§å¯¹è±¡)ï¼Œä½†åˆç»å¸¸ç”¨åˆ°çš„å¯¹è±¡ã€å·¥å…·ç±»å¯¹è±¡ã€é¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡(æ¯”å¦‚æ•°æ®æºã€session å·¥å‚ç­‰)","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]}]}